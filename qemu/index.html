<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="work and study notes"><meta name=author content=Pikaqiu><link href=https://panda-zcj.github.io/note/qemu/ rel=canonical><link href=../embedded_development/ rel=prev><link href=../os/linux/ rel=next><link rel=icon href=../assets/images/favicon.png><meta name=generator content="mkdocs-1.5.3, mkdocs-material-9.5.17"><title>芯片功能仿真 - Pikaqiu Docs</title><link rel=stylesheet href=../assets/stylesheets/main.bcfcd587.min.css><link rel=stylesheet href=../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script> <link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../assets/javascripts/glightbox.min.js"></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=teal data-md-color-accent=blue> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#qemu class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title="Pikaqiu Docs" class="md-header__button md-logo" aria-label="Pikaqiu Docs" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="m57.7 193 9.4 16.4c8.3 14.5 21.9 25.2 38 29.8l57.9 16.5c17.2 4.9 29 20.6 29 38.5v39.9c0 11 6.2 21 16 25.9s16 14.9 16 25.9v39c0 15.6 14.9 26.9 29.9 22.6 16.1-4.6 28.6-17.5 32.7-33.8l2.8-11.2c4.2-16.9 15.2-31.4 30.3-40l8.1-4.6c15-8.5 24.2-24.5 24.2-41.7v-8.3c0-12.7-5.1-24.9-14.1-33.9l-3.9-3.9c-9-9-21.2-14.1-33.9-14.1H257c-11.1 0-22.1-2.9-31.8-8.4l-34.5-19.7c-4.3-2.5-7.6-6.5-9.2-11.2-3.2-9.6 1.1-20 10.2-24.5l5.9-3c6.6-3.3 14.3-3.9 21.3-1.5l23.2 7.7c8.2 2.7 17.2-.4 21.9-7.5 4.7-7 4.2-16.3-1.2-22.8l-13.6-16.3c-10-12-9.9-29.5.3-41.3l15.7-18.3c8.8-10.3 10.2-25 3.5-36.7l-2.4-4.2c-3.5-.2-6.9-.3-10.4-.3-92.8 0-171.5 60.9-198.2 145zM464 256c0-36.8-9.6-71.4-26.4-101.5L412 164.8c-15.7 6.3-23.8 23.8-18.5 39.8l16.9 50.7c3.5 10.4 12 18.3 22.6 20.9l29.1 7.3c1.2-9 1.8-18.2 1.8-27.5zM0 256a256 256 0 1 1 512 0 256 256 0 1 1-512 0z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Pikaqiu Docs </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> 芯片功能仿真 </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=teal data-md-color-accent=blue aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=cyan data-md-color-accent=amber aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://gitee.com/pikaqiu_zcj/mkdocs title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> pikaqiu/mkdocs </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title="Pikaqiu Docs" class="md-nav__button md-logo" aria-label="Pikaqiu Docs" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="m57.7 193 9.4 16.4c8.3 14.5 21.9 25.2 38 29.8l57.9 16.5c17.2 4.9 29 20.6 29 38.5v39.9c0 11 6.2 21 16 25.9s16 14.9 16 25.9v39c0 15.6 14.9 26.9 29.9 22.6 16.1-4.6 28.6-17.5 32.7-33.8l2.8-11.2c4.2-16.9 15.2-31.4 30.3-40l8.1-4.6c15-8.5 24.2-24.5 24.2-41.7v-8.3c0-12.7-5.1-24.9-14.1-33.9l-3.9-3.9c-9-9-21.2-14.1-33.9-14.1H257c-11.1 0-22.1-2.9-31.8-8.4l-34.5-19.7c-4.3-2.5-7.6-6.5-9.2-11.2-3.2-9.6 1.1-20 10.2-24.5l5.9-3c6.6-3.3 14.3-3.9 21.3-1.5l23.2 7.7c8.2 2.7 17.2-.4 21.9-7.5 4.7-7 4.2-16.3-1.2-22.8l-13.6-16.3c-10-12-9.9-29.5.3-41.3l15.7-18.3c8.8-10.3 10.2-25 3.5-36.7l-2.4-4.2c-3.5-.2-6.9-.3-10.4-.3-92.8 0-171.5 60.9-198.2 145zM464 256c0-36.8-9.6-71.4-26.4-101.5L412 164.8c-15.7 6.3-23.8 23.8-18.5 39.8l16.9 50.7c3.5 10.4 12 18.3 22.6 20.9l29.1 7.3c1.2-9 1.8-18.2 1.8-27.5zM0 256a256 256 0 1 1 512 0 256 256 0 1 1-512 0z"/></svg> </a> Pikaqiu Docs </label> <div class=md-nav__source> <a href=https://gitee.com/pikaqiu_zcj/mkdocs title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> pikaqiu/mkdocs </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> <span class=md-ellipsis> MkDocs教程 </span> </a> </li> <li class=md-nav__item> <a href=../algorithm/ class=md-nav__link> <span class=md-ellipsis> 面试算法 </span> </a> </li> <li class=md-nav__item> <a href=../database/ class=md-nav__link> <span class=md-ellipsis> 数据库 </span> </a> </li> <li class=md-nav__item> <a href=../embedded_development/ class=md-nav__link> <span class=md-ellipsis> 嵌入式开发 </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> 芯片功能仿真 </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> 芯片功能仿真 </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#0 class=md-nav__link> <span class=md-ellipsis> 0. 引言 </span> </a> </li> <li class=md-nav__item> <a href=#1 class=md-nav__link> <span class=md-ellipsis> 1. 环境部署 </span> </a> </li> <li class=md-nav__item> <a href=#2-qemu class=md-nav__link> <span class=md-ellipsis> 2. Qemu使用手册 </span> </a> <nav class=md-nav aria-label="2. Qemu使用手册"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#21-qemu class=md-nav__link> <span class=md-ellipsis> 2.1. QEMU 命令详解 </span> </a> <nav class=md-nav aria-label="2.1. QEMU 命令详解"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#211-qemu-system- class=md-nav__link> <span class=md-ellipsis> 2.1.1. qemu-system-[目标机器架构] </span> </a> </li> <li class=md-nav__item> <a href=#212-qemu-cpu class=md-nav__link> <span class=md-ellipsis> 2.1.2. qemu-[CPU 架构] </span> </a> </li> <li class=md-nav__item> <a href=#213-qemu-img class=md-nav__link> <span class=md-ellipsis> 2.1.3. qemu-img </span> </a> </li> <li class=md-nav__item> <a href=#214-qemu-store-daemon class=md-nav__link> <span class=md-ellipsis> 2.1.4. qemu-store-daemon </span> </a> </li> <li class=md-nav__item> <a href=#215-qemu-nbd class=md-nav__link> <span class=md-ellipsis> 2.1.5. qemu-nbd </span> </a> </li> <li class=md-nav__item> <a href=#216-qemu-pr-helper class=md-nav__link> <span class=md-ellipsis> 2.1.6. qemu-pr-helper </span> </a> </li> <li class=md-nav__item> <a href=#217-qemu-trace-stap class=md-nav__link> <span class=md-ellipsis> 2.1.7. qemu-trace-stap </span> </a> </li> <li class=md-nav__item> <a href=#218-virtfs-proxy-helper class=md-nav__link> <span class=md-ellipsis> 2.1.8. virtfs-proxy-helper </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#22-qemu class=md-nav__link> <span class=md-ellipsis> 2.2. QEMU编译测试框架 </span> </a> <nav class=md-nav aria-label="2.2. QEMU编译测试框架"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#221-qemu class=md-nav__link> <span class=md-ellipsis> 2.2.1. QEMU编译框架 </span> </a> <nav class=md-nav aria-label="2.2.1. QEMU编译框架"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2211-configure class=md-nav__link> <span class=md-ellipsis> 2.2.1.1. configure </span> </a> </li> <li class=md-nav__item> <a href=#2212-meson class=md-nav__link> <span class=md-ellipsis> 2.2.1.2. Meson </span> </a> </li> <li class=md-nav__item> <a href=#2213-make class=md-nav__link> <span class=md-ellipsis> 2.2.1.3. Make </span> </a> </li> <li class=md-nav__item> <a href=#2214-important-files-for-the-build-system class=md-nav__link> <span class=md-ellipsis> 2.2.1.4. Important files for the build system </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#222-qemu-and-kconfig class=md-nav__link> <span class=md-ellipsis> 2.2.2. QEMU and Kconfig </span> </a> <nav class=md-nav aria-label="2.2.2. QEMU and Kconfig"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2221-the-kconfig-language class=md-nav__link> <span class=md-ellipsis> 2.2.2.1. The Kconfig language </span> </a> </li> <li class=md-nav__item> <a href=#2222-guidelines-for-writing-kconfig-files class=md-nav__link> <span class=md-ellipsis> 2.2.2.2. Guidelines for writing Kconfig files </span> </a> </li> <li class=md-nav__item> <a href=#2223-writing-and-modifying-default-configurations class=md-nav__link> <span class=md-ellipsis> 2.2.2.3. Writing and modifying default configurations </span> </a> </li> <li class=md-nav__item> <a href=#2224-kconfighost class=md-nav__link> <span class=md-ellipsis> 2.2.2.4. Kconfig.host </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#223-qemu-documentation class=md-nav__link> <span class=md-ellipsis> 2.2.3. QEMU Documentation </span> </a> <nav class=md-nav aria-label="2.2.3. QEMU Documentation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2231-xtool-and-hx-files class=md-nav__link> <span class=md-ellipsis> 2.2.3.1. xtool and .hx files </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#224-testing-in-qemu class=md-nav__link> <span class=md-ellipsis> 2.2.4. Testing in QEMU </span> </a> <nav class=md-nav aria-label="2.2.4. Testing in QEMU"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2241-testing-with-make-check class=md-nav__link> <span class=md-ellipsis> 2.2.4.1. Testing with "make check" </span> </a> </li> <li class=md-nav__item> <a href=#2242-qemu-iotests class=md-nav__link> <span class=md-ellipsis> 2.2.4.2. QEMU iotests </span> </a> </li> <li class=md-nav__item> <a href=#2243-container-based-tests class=md-nav__link> <span class=md-ellipsis> 2.2.4.3. Container based tests </span> </a> </li> <li class=md-nav__item> <a href=#2244-thread-sanitizer class=md-nav__link> <span class=md-ellipsis> 2.2.4.4. Thread Sanitizer </span> </a> </li> <li class=md-nav__item> <a href=#2245-docker-binfmt-image-debian-targets class=md-nav__link> <span class=md-ellipsis> 2.2.4.5. docker-binfmt-image-debian-% targets </span> </a> </li> <li class=md-nav__item> <a href=#2246-vm-testing class=md-nav__link> <span class=md-ellipsis> 2.2.4.6. VM testing </span> </a> </li> <li class=md-nav__item> <a href=#2247-image-fuzzer-testing class=md-nav__link> <span class=md-ellipsis> 2.2.4.7. Image fuzzer testing </span> </a> </li> <li class=md-nav__item> <a href=#2248-integration-tests-using-the-avocado-framework class=md-nav__link> <span class=md-ellipsis> 2.2.4.8. Integration tests using the Avocado Framework </span> </a> </li> <li class=md-nav__item> <a href=#2249-testing-with-make-check-tcg class=md-nav__link> <span class=md-ellipsis> 2.2.4.9. Testing with "make check-tcg" </span> </a> </li> <li class=md-nav__item> <a href=#22410-other-tcg-tests class=md-nav__link> <span class=md-ellipsis> 2.2.4.10. Other TCG Tests </span> </a> </li> <li class=md-nav__item> <a href=#22411-gcc-gcov-support class=md-nav__link> <span class=md-ellipsis> 2.2.4.11. GCC gcov support </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#225-acpismbios-avocado-tests-using-biosbits class=md-nav__link> <span class=md-ellipsis> 2.2.5. ACPI/SMBIOS avocado tests using biosbits </span> </a> <nav class=md-nav aria-label="2.2.5. ACPI/SMBIOS avocado tests using biosbits"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2251-references class=md-nav__link> <span class=md-ellipsis> 2.2.5.1. References </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#226-qtest-device-emulation-testing-framework class=md-nav__link> <span class=md-ellipsis> 2.2.6. QTest Device Emulation Testing Framework </span> </a> <nav class=md-nav aria-label="2.2.6. QTest Device Emulation Testing Framework"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2261-qtest-driver-framework class=md-nav__link> <span class=md-ellipsis> 2.2.6.1. Qtest Driver Framework </span> </a> </li> <li class=md-nav__item> <a href=#2262-qtest-protocol class=md-nav__link> <span class=md-ellipsis> 2.2.6.2. QTest Protocol </span> </a> </li> <li class=md-nav__item> <a href=#2263-libqtest-api-reference class=md-nav__link> <span class=md-ellipsis> 2.2.6.3. libqtest API reference </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#227-ci class=md-nav__link> <span class=md-ellipsis> 2.2.7. CI </span> </a> <nav class=md-nav aria-label="2.2.7. CI"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2271-definition-of-terms class=md-nav__link> <span class=md-ellipsis> 2.2.7.1. Definition of terms </span> </a> </li> <li class=md-nav__item> <a href=#2272-custom-cicd-variables class=md-nav__link> <span class=md-ellipsis> 2.2.7.2. Custom CI/CD variables </span> </a> </li> <li class=md-nav__item> <a href=#2273-jobs-on-custom-runners class=md-nav__link> <span class=md-ellipsis> 2.2.7.3. Jobs on Custom Runners </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#228-how-to-use-the-qapi-code-generator class=md-nav__link> <span class=md-ellipsis> 2.2.8. How to use the QAPI code generator </span> </a> <nav class=md-nav aria-label="2.2.8. How to use the QAPI code generator"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2281-introduction class=md-nav__link> <span class=md-ellipsis> 2.2.8.1. Introduction </span> </a> </li> <li class=md-nav__item> <a href=#2282-the-qapi-schema-language class=md-nav__link> <span class=md-ellipsis> 2.2.8.2. The QAPI schema language </span> </a> </li> <li class=md-nav__item> <a href=#2283-client-json-protocol-introspection class=md-nav__link> <span class=md-ellipsis> 2.2.8.3. Client JSON Protocol introspection </span> </a> </li> <li class=md-nav__item> <a href=#2284-compatibility-considerations class=md-nav__link> <span class=md-ellipsis> 2.2.8.4. Compatibility considerations </span> </a> </li> <li class=md-nav__item> <a href=#2285-code-generation class=md-nav__link> <span class=md-ellipsis> 2.2.8.5. Code generation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#229-fuzzing class=md-nav__link> <span class=md-ellipsis> 2.2.9. Fuzzing </span> </a> <nav class=md-nav aria-label="2.2.9. Fuzzing"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2291-basics class=md-nav__link> <span class=md-ellipsis> 2.2.9.1. Basics </span> </a> </li> <li class=md-nav__item> <a href=#2292-building-the-fuzzers class=md-nav__link> <span class=md-ellipsis> 2.2.9.2. Building the fuzzers </span> </a> </li> <li class=md-nav__item> <a href=#2293-useful-libfuzzer-flags class=md-nav__link> <span class=md-ellipsis> 2.2.9.3. Useful libFuzzer flags </span> </a> </li> <li class=md-nav__item> <a href=#2294-generating-coverage-reports class=md-nav__link> <span class=md-ellipsis> 2.2.9.4. Generating Coverage Reports </span> </a> </li> <li class=md-nav__item> <a href=#2295-adding-a-new-fuzzer class=md-nav__link> <span class=md-ellipsis> 2.2.9.5. Adding a new fuzzer </span> </a> </li> <li class=md-nav__item> <a href=#2296-the-generic-fuzzer class=md-nav__link> <span class=md-ellipsis> 2.2.9.6. The Generic Fuzzer </span> </a> </li> <li class=md-nav__item> <a href=#2297-oss-fuzz class=md-nav__link> <span class=md-ellipsis> 2.2.9.7. OSS-Fuzz </span> </a> </li> <li class=md-nav__item> <a href=#2298-building-crash-reproducers class=md-nav__link> <span class=md-ellipsis> 2.2.9.8. Building Crash Reproducers </span> </a> </li> <li class=md-nav__item> <a href=#2299-implementation-details-fuzzer-lifecycle class=md-nav__link> <span class=md-ellipsis> 2.2.9.9. Implementation Details / Fuzzer Lifecycle </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2210-control-flow-integrity-cfi class=md-nav__link> <span class=md-ellipsis> 2.2.10. Control-Flow Integrity (CFI) </span> </a> <nav class=md-nav aria-label="2.2.10. Control-Flow Integrity (CFI)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#22101-basics class=md-nav__link> <span class=md-ellipsis> 2.2.10.1. Basics </span> </a> </li> <li class=md-nav__item> <a href=#22102-building-with-cfi class=md-nav__link> <span class=md-ellipsis> 2.2.10.2. Building with CFI </span> </a> </li> <li class=md-nav__item> <a href=#22103-using-qemu-built-with-cfi class=md-nav__link> <span class=md-ellipsis> 2.2.10.3. Using QEMU built with CFI </span> </a> </li> <li class=md-nav__item> <a href=#22104-incompatible-code-with-cfi class=md-nav__link> <span class=md-ellipsis> 2.2.10.4. Incompatible code with CFI </span> </a> </li> <li class=md-nav__item> <a href=#22105-disabling-cfi-for-a-specific-function class=md-nav__link> <span class=md-ellipsis> 2.2.10.5. Disabling CFI for a specific function </span> </a> </li> <li class=md-nav__item> <a href=#22106-cfi-and-fuzzing class=md-nav__link> <span class=md-ellipsis> 2.2.10.6. CFI and fuzzing </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#23-qemutcg class=md-nav__link> <span class=md-ellipsis> 2.3. QEMU翻译原理TCG </span> </a> <nav class=md-nav aria-label="2.3. QEMU翻译原理TCG"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#231-translator-internals class=md-nav__link> <span class=md-ellipsis> 2.3.1. Translator Internals </span> </a> <nav class=md-nav aria-label="2.3.1. Translator Internals"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2311-cpu-state-optimisations class=md-nav__link> <span class=md-ellipsis> 2.3.1.1. CPU state optimisations </span> </a> </li> <li class=md-nav__item> <a href=#2312-direct-block-chaining class=md-nav__link> <span class=md-ellipsis> 2.3.1.2. Direct block chaining </span> </a> </li> <li class=md-nav__item> <a href=#2313-self-modifying-code-and-translated-code-invalidation class=md-nav__link> <span class=md-ellipsis> 2.3.1.3. Self-modifying code and translated code invalidation </span> </a> </li> <li class=md-nav__item> <a href=#2314-exception-support class=md-nav__link> <span class=md-ellipsis> 2.3.1.4. Exception support </span> </a> </li> <li class=md-nav__item> <a href=#2315-mmu-emulation class=md-nav__link> <span class=md-ellipsis> 2.3.1.5. MMU emulation </span> </a> </li> <li class=md-nav__item> <a href=#2316-profiling-jitted-code class=md-nav__link> <span class=md-ellipsis> 2.3.1.6. Profiling JITted code </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#232-tcg-intermediate-representation class=md-nav__link> <span class=md-ellipsis> 2.3.2. TCG Intermediate Representation </span> </a> <nav class=md-nav aria-label="2.3.2. TCG Intermediate Representation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2321-introduction class=md-nav__link> <span class=md-ellipsis> 2.3.2.1. Introduction </span> </a> </li> <li class=md-nav__item> <a href=#2322-definitions class=md-nav__link> <span class=md-ellipsis> 2.3.2.2. Definitions </span> </a> </li> <li class=md-nav__item> <a href=#2323-basic-blocks class=md-nav__link> <span class=md-ellipsis> 2.3.2.3. Basic Blocks </span> </a> </li> <li class=md-nav__item> <a href=#2324-operations class=md-nav__link> <span class=md-ellipsis> 2.3.2.4. Operations </span> </a> </li> <li class=md-nav__item> <a href=#2325-variables class=md-nav__link> <span class=md-ellipsis> 2.3.2.5. Variables </span> </a> </li> <li class=md-nav__item> <a href=#2326-types class=md-nav__link> <span class=md-ellipsis> 2.3.2.6. Types </span> </a> </li> <li class=md-nav__item> <a href=#2327-helpers class=md-nav__link> <span class=md-ellipsis> 2.3.2.7. Helpers </span> </a> </li> <li class=md-nav__item> <a href=#2328-code-optimizations class=md-nav__link> <span class=md-ellipsis> 2.3.2.8. Code Optimizations </span> </a> </li> <li class=md-nav__item> <a href=#2329-instruction-reference class=md-nav__link> <span class=md-ellipsis> 2.3.2.9. Instruction Reference </span> </a> </li> <li class=md-nav__item> <a href=#23210-backend class=md-nav__link> <span class=md-ellipsis> 2.3.2.10. Backend </span> </a> </li> <li class=md-nav__item> <a href=#23211-recommended-coding-rules-for-best-performance class=md-nav__link> <span class=md-ellipsis> 2.3.2.11. Recommended coding rules for best performance </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#233-decodetree-specification class=md-nav__link> <span class=md-ellipsis> 2.3.3. Decodetree Specification </span> </a> <nav class=md-nav aria-label="2.3.3. Decodetree Specification"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2331-fields class=md-nav__link> <span class=md-ellipsis> 2.3.3.1. Fields </span> </a> </li> <li class=md-nav__item> <a href=#2332-argument-sets class=md-nav__link> <span class=md-ellipsis> 2.3.3.2. Argument Sets </span> </a> </li> <li class=md-nav__item> <a href=#2333-formats class=md-nav__link> <span class=md-ellipsis> 2.3.3.3. Formats </span> </a> </li> <li class=md-nav__item> <a href=#2334-patterns class=md-nav__link> <span class=md-ellipsis> 2.3.3.4. Patterns </span> </a> </li> <li class=md-nav__item> <a href=#2335-pattern-groups class=md-nav__link> <span class=md-ellipsis> 2.3.3.5. Pattern Groups </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#234-multi-threaded-tcg class=md-nav__link> <span class=md-ellipsis> 2.3.4. Multi-threaded TCG </span> </a> <nav class=md-nav aria-label="2.3.4. Multi-threaded TCG"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2341-vcpu-scheduling class=md-nav__link> <span class=md-ellipsis> 2.3.4.1. vCPU Scheduling </span> </a> </li> <li class=md-nav__item> <a href=#2342-shared-data-structures class=md-nav__link> <span class=md-ellipsis> 2.3.4.2. Shared Data Structures </span> </a> </li> <li class=md-nav__item> <a href=#2343-memory-consistency class=md-nav__link> <span class=md-ellipsis> 2.3.4.3. Memory Consistency </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#235-tcg-instruction-counting class=md-nav__link> <span class=md-ellipsis> 2.3.5. TCG Instruction Counting </span> </a> <nav class=md-nav aria-label="2.3.5. TCG Instruction Counting"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2351-core-concepts class=md-nav__link> <span class=md-ellipsis> 2.3.5.1. Core Concepts </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#236-qemu-tcg-plugins class=md-nav__link> <span class=md-ellipsis> 2.3.6. QEMU TCG Plugins </span> </a> <nav class=md-nav aria-label="2.3.6. QEMU TCG Plugins"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2361-usage class=md-nav__link> <span class=md-ellipsis> 2.3.6.1. Usage </span> </a> </li> <li class=md-nav__item> <a href=#2362-writing-plugins class=md-nav__link> <span class=md-ellipsis> 2.3.6.2. Writing plugins </span> </a> </li> <li class=md-nav__item> <a href=#2363-internals class=md-nav__link> <span class=md-ellipsis> 2.3.6.3. Internals </span> </a> </li> <li class=md-nav__item> <a href=#2364-example-plugins class=md-nav__link> <span class=md-ellipsis> 2.3.6.4. Example Plugins </span> </a> </li> <li class=md-nav__item> <a href=#2365-api class=md-nav__link> <span class=md-ellipsis> 2.3.6.5. API </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#237-execution-recordreplay class=md-nav__link> <span class=md-ellipsis> 2.3.7. Execution Record/Replay </span> </a> <nav class=md-nav aria-label="2.3.7. Execution Record/Replay"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2371-core-concepts class=md-nav__link> <span class=md-ellipsis> 2.3.7.1. Core concepts </span> </a> </li> <li class=md-nav__item> <a href=#2372-virtual-devices class=md-nav__link> <span class=md-ellipsis> 2.3.7.2. Virtual devices </span> </a> </li> <li class=md-nav__item> <a href=#2373-replay-log-format class=md-nav__link> <span class=md-ellipsis> 2.3.7.3. Replay log format </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#24-qemu class=md-nav__link> <span class=md-ellipsis> 2.4. QEMU 子模块 </span> </a> <nav class=md-nav aria-label="2.4. QEMU 子模块"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#241-the-qemu-object-model-qom class=md-nav__link> <span class=md-ellipsis> 2.4.1. The QEMU Object Model (QOM) </span> </a> <nav class=md-nav aria-label="2.4.1. The QEMU Object Model (QOM)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2411-the-qom-tree class=md-nav__link> <span class=md-ellipsis> 2.4.1.1. The QOM tree </span> </a> </li> <li class=md-nav__item> <a href=#2412-creating-a-qom-class class=md-nav__link> <span class=md-ellipsis> 2.4.1.2. Creating a QOM class </span> </a> </li> <li class=md-nav__item> <a href=#2413-standard-type-declaration-and-definition-macros class=md-nav__link> <span class=md-ellipsis> 2.4.1.3. Standard type declaration and definition macros </span> </a> </li> <li class=md-nav__item> <a href=#2414-device-life-cycle class=md-nav__link> <span class=md-ellipsis> 2.4.1.4. Device Life-cycle </span> </a> </li> <li class=md-nav__item> <a href=#2415-api-reference class=md-nav__link> <span class=md-ellipsis> 2.4.1.5. API Reference </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#242-atomic-operations-in-qemu class=md-nav__link> <span class=md-ellipsis> 2.4.2. Atomic operations in QEMU </span> </a> <nav class=md-nav aria-label="2.4.2. Atomic operations in QEMU"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2421-compiler-memory-barrier class=md-nav__link> <span class=md-ellipsis> 2.4.2.1. Compiler memory barrier </span> </a> </li> <li class=md-nav__item> <a href=#2422-sequentially-consistent-atomic-access class=md-nav__link> <span class=md-ellipsis> 2.4.2.2. Sequentially consistent atomic access </span> </a> </li> <li class=md-nav__item> <a href=#2423-weak-atomic-access-and-manual-memory-barriers class=md-nav__link> <span class=md-ellipsis> 2.4.2.3. Weak atomic access and manual memory barriers </span> </a> </li> <li class=md-nav__item> <a href=#2424-comparison-with-linux-kernel-primitives class=md-nav__link> <span class=md-ellipsis> 2.4.2.4. Comparison with Linux kernel primitives </span> </a> </li> <li class=md-nav__item> <a href=#2425-sources class=md-nav__link> <span class=md-ellipsis> 2.4.2.5. Sources </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#243-block-coroutine-wrapper class=md-nav__link> <span class=md-ellipsis> 2.4.3. block-coroutine-wrapper </span> </a> <nav class=md-nav aria-label="2.4.3. block-coroutine-wrapper"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2431-usage class=md-nav__link> <span class=md-ellipsis> 2.4.3.1. Usage </span> </a> </li> <li class=md-nav__item> <a href=#2432-links class=md-nav__link> <span class=md-ellipsis> 2.4.3.2. Links </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#244-modelling-a-clock-tree-in-qemu class=md-nav__link> <span class=md-ellipsis> 2.4.4. Modelling a clock tree in QEMU </span> </a> <nav class=md-nav aria-label="2.4.4. Modelling a clock tree in QEMU"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2441-what-are-clocks class=md-nav__link> <span class=md-ellipsis> 2.4.4.1. What are clocks? </span> </a> </li> <li class=md-nav__item> <a href=#2442-the-clock-state class=md-nav__link> <span class=md-ellipsis> 2.4.4.2. The clock state </span> </a> </li> <li class=md-nav__item> <a href=#2443-adding-a-new-clock class=md-nav__link> <span class=md-ellipsis> 2.4.4.3. Adding a new clock </span> </a> </li> <li class=md-nav__item> <a href=#2444-clock-callbacks class=md-nav__link> <span class=md-ellipsis> 2.4.4.4. Clock callbacks </span> </a> </li> <li class=md-nav__item> <a href=#2445-retrieving-clocks-from-a-device class=md-nav__link> <span class=md-ellipsis> 2.4.4.5. Retrieving clocks from a device </span> </a> </li> <li class=md-nav__item> <a href=#2446-connecting-two-clocks-together class=md-nav__link> <span class=md-ellipsis> 2.4.4.6. Connecting two clocks together </span> </a> </li> <li class=md-nav__item> <a href=#2447-clock-multiplier-and-divider-settings class=md-nav__link> <span class=md-ellipsis> 2.4.4.7. Clock multiplier and divider settings </span> </a> </li> <li class=md-nav__item> <a href=#2448-unconnected-input-clocks class=md-nav__link> <span class=md-ellipsis> 2.4.4.8. Unconnected input clocks </span> </a> </li> <li class=md-nav__item> <a href=#2449-fetching-clock-frequencyperiod class=md-nav__link> <span class=md-ellipsis> 2.4.4.9. Fetching clock frequency/period </span> </a> </li> <li class=md-nav__item> <a href=#24410-calculating-expiry-deadlines class=md-nav__link> <span class=md-ellipsis> 2.4.4.10. Calculating expiry deadlines </span> </a> </li> <li class=md-nav__item> <a href=#24411-obtaining-tick-counts class=md-nav__link> <span class=md-ellipsis> 2.4.4.11. Obtaining tick counts </span> </a> </li> <li class=md-nav__item> <a href=#24412-changing-a-clock-period class=md-nav__link> <span class=md-ellipsis> 2.4.4.12. Changing a clock period </span> </a> </li> <li class=md-nav__item> <a href=#24413-aliasing-clocks class=md-nav__link> <span class=md-ellipsis> 2.4.4.13. Aliasing clocks </span> </a> </li> <li class=md-nav__item> <a href=#24414-migration class=md-nav__link> <span class=md-ellipsis> 2.4.4.14. Migration </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#245-ebpf-rss-virtio-net-support class=md-nav__link> <span class=md-ellipsis> 2.4.5. eBPF RSS virtio-net support </span> </a> <nav class=md-nav aria-label="2.4.5. eBPF RSS virtio-net support"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2451-rss-ebpf-program class=md-nav__link> <span class=md-ellipsis> 2.4.5.1. RSS eBPF program </span> </a> </li> <li class=md-nav__item> <a href=#2452-ebpf-rss-implementation class=md-nav__link> <span class=md-ellipsis> 2.4.5.2. eBPF RSS implementation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#246-migration class=md-nav__link> <span class=md-ellipsis> 2.4.6. Migration </span> </a> <nav class=md-nav aria-label="2.4.6. Migration"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2461-migration-framework class=md-nav__link> <span class=md-ellipsis> 2.4.6.1. Migration framework </span> </a> </li> <li class=md-nav__item> <a href=#2462-migration-features class=md-nav__link> <span class=md-ellipsis> 2.4.6.2. Migration features </span> </a> </li> <li class=md-nav__item> <a href=#2463-backwards-compatibility class=md-nav__link> <span class=md-ellipsis> 2.4.6.3. Backwards compatibility </span> </a> </li> <li class=md-nav__item> <a href=#2464-best-practices class=md-nav__link> <span class=md-ellipsis> 2.4.6.4. Best practices </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#247-multi-process-qemu class=md-nav__link> <span class=md-ellipsis> 2.4.7. Multi-process QEMU </span> </a> <nav class=md-nav aria-label="2.4.7. Multi-process QEMU"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2471-qemu-services class=md-nav__link> <span class=md-ellipsis> 2.4.7.1. QEMU services </span> </a> </li> <li class=md-nav__item> <a href=#2472-separating-io-services class=md-nav__link> <span class=md-ellipsis> 2.4.7.2. Separating IO services </span> </a> </li> <li class=md-nav__item> <a href=#2473-new-separation-model-based-on-proxy-objects class=md-nav__link> <span class=md-ellipsis> 2.4.7.3. New separation model based on proxy objects </span> </a> </li> <li class=md-nav__item> <a href=#2474-disaggregated-cpu-emulation class=md-nav__link> <span class=md-ellipsis> 2.4.7.4. Disaggregated CPU emulation </span> </a> </li> <li class=md-nav__item> <a href=#2475-host-access-controls class=md-nav__link> <span class=md-ellipsis> 2.4.7.5. Host access controls </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#248-reset-in-qemu-the-resettable-interface class=md-nav__link> <span class=md-ellipsis> 2.4.8. Reset in QEMU: the Resettable interface </span> </a> <nav class=md-nav aria-label="2.4.8. Reset in QEMU: the Resettable interface"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2481-triggering-reset class=md-nav__link> <span class=md-ellipsis> 2.4.8.1. Triggering reset </span> </a> </li> <li class=md-nav__item> <a href=#2482-multi-phase-mechanism class=md-nav__link> <span class=md-ellipsis> 2.4.8.2. Multi-phase mechanism </span> </a> </li> <li class=md-nav__item> <a href=#2483-handling-reset-in-a-resettable-object class=md-nav__link> <span class=md-ellipsis> 2.4.8.3. Handling reset in a resettable object </span> </a> </li> <li class=md-nav__item> <a href=#2484-base-class-handling-of-reset class=md-nav__link> <span class=md-ellipsis> 2.4.8.4. Base class handling of reset </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#249-qapi-interface-for-s390-cpu-topology class=md-nav__link> <span class=md-ellipsis> 2.4.9. QAPI interface for S390 CPU topology </span> </a> <nav class=md-nav aria-label="2.4.9. QAPI interface for S390 CPU topology"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2491-additions-to-query-cpus-fast class=md-nav__link> <span class=md-ellipsis> 2.4.9.1. Additions to query-cpus-fast </span> </a> </li> <li class=md-nav__item> <a href=#2492-qapi-command-set-cpu-topology class=md-nav__link> <span class=md-ellipsis> 2.4.9.2. QAPI command: set-cpu-topology </span> </a> </li> <li class=md-nav__item> <a href=#2493-qapi-event-cpu_polarization_change class=md-nav__link> <span class=md-ellipsis> 2.4.9.3. QAPI event CPU_POLARIZATION_CHANGE </span> </a> </li> <li class=md-nav__item> <a href=#2494-qapi-query-command-query-s390x-cpu-polarization class=md-nav__link> <span class=md-ellipsis> 2.4.9.4. QAPI query command: query-s390x-cpu-polarization </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2410-booting-from-real-channel-attached-devices-on-s390x class=md-nav__link> <span class=md-ellipsis> 2.4.10. Booting from real channel-attached devices on s390x </span> </a> <nav class=md-nav aria-label="2.4.10. Booting from real channel-attached devices on s390x"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#24101-s390-hardware-ipl class=md-nav__link> <span class=md-ellipsis> 2.4.10.1. s390 hardware IPL </span> </a> </li> <li class=md-nav__item> <a href=#24102-how-this-all-pertains-to-qemu-and-the-kernel class=md-nav__link> <span class=md-ellipsis> 2.4.10.2. How this all pertains to QEMU (and the kernel) </span> </a> </li> <li class=md-nav__item> <a href=#24103-what-qemu-does class=md-nav__link> <span class=md-ellipsis> 2.4.10.3. What QEMU does </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2411-tracing class=md-nav__link> <span class=md-ellipsis> 2.4.11. Tracing </span> </a> <nav class=md-nav aria-label="2.4.11. Tracing"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#24111-introduction class=md-nav__link> <span class=md-ellipsis> 2.4.11.1. Introduction </span> </a> </li> <li class=md-nav__item> <a href=#24112-quickstart class=md-nav__link> <span class=md-ellipsis> 2.4.11.2. Quickstart </span> </a> </li> <li class=md-nav__item> <a href=#24113-trace-events class=md-nav__link> <span class=md-ellipsis> 2.4.11.3. Trace events </span> </a> </li> <li class=md-nav__item> <a href=#24114-generic-interface-and-monitor-commands class=md-nav__link> <span class=md-ellipsis> 2.4.11.4. Generic interface and monitor commands </span> </a> </li> <li class=md-nav__item> <a href=#24115-trace-backends class=md-nav__link> <span class=md-ellipsis> 2.4.11.5. Trace backends </span> </a> </li> <li class=md-nav__item> <a href=#24116-trace-event-properties class=md-nav__link> <span class=md-ellipsis> 2.4.11.6. Trace event properties </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2412-iommufd-backend-usage-with-vfio class=md-nav__link> <span class=md-ellipsis> 2.4.12. IOMMUFD BACKEND usage with VFIO </span> </a> <nav class=md-nav aria-label="2.4.12. IOMMUFD BACKEND usage with VFIO"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#24121-example-configuration class=md-nav__link> <span class=md-ellipsis> 2.4.12.1. Example configuration </span> </a> </li> <li class=md-nav__item> <a href=#24122-supported-platform class=md-nav__link> <span class=md-ellipsis> 2.4.12.2. Supported platform </span> </a> </li> <li class=md-nav__item> <a href=#24123-caveats class=md-nav__link> <span class=md-ellipsis> 2.4.12.3. Caveats </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2413-how-to-write-monitor-commands class=md-nav__link> <span class=md-ellipsis> 2.4.13. How to write monitor commands </span> </a> <nav class=md-nav aria-label="2.4.13. How to write monitor commands"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#24131-overview class=md-nav__link> <span class=md-ellipsis> 2.4.13.1. Overview </span> </a> </li> <li class=md-nav__item> <a href=#24132-testing class=md-nav__link> <span class=md-ellipsis> 2.4.13.2. Testing </span> </a> </li> <li class=md-nav__item> <a href=#24133-writing-a-simple-command-hello-world class=md-nav__link> <span class=md-ellipsis> 2.4.13.3. Writing a simple command: hello-world </span> </a> </li> <li class=md-nav__item> <a href=#24134-writing-more-complex-commands class=md-nav__link> <span class=md-ellipsis> 2.4.13.4. Writing more complex commands </span> </a> </li> <li class=md-nav__item> <a href=#24135-writing-a-debugging-aid-returning-unstructured-text class=md-nav__link> <span class=md-ellipsis> 2.4.13.5. Writing a debugging aid returning unstructured text </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2414-writing-virtio-backends-for-qemu class=md-nav__link> <span class=md-ellipsis> 2.4.14. Writing VirtIO backends for QEMU </span> </a> <nav class=md-nav aria-label="2.4.14. Writing VirtIO backends for QEMU"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#24141-virtio-transports class=md-nav__link> <span class=md-ellipsis> 2.4.14.1. VirtIO Transports </span> </a> </li> <li class=md-nav__item> <a href=#24142-using-the-qemu-object-model-qom class=md-nav__link> <span class=md-ellipsis> 2.4.14.2. Using the QEMU Object Model (QOM) </span> </a> </li> <li class=md-nav__item> <a href=#24143-back-end-implementations class=md-nav__link> <span class=md-ellipsis> 2.4.14.3. Back End Implementations </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#25-qemu class=md-nav__link> <span class=md-ellipsis> 2.5. QEMU 目录结构 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#3 class=md-nav__link> <span class=md-ellipsis> 3. 笔记 </span> </a> <nav class=md-nav aria-label="3. 笔记"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#31 class=md-nav__link> <span class=md-ellipsis> 3.1. 虚拟化是什么？ </span> </a> </li> <li class=md-nav__item> <a href=#32-qemu class=md-nav__link> <span class=md-ellipsis> 3.2. Qemu是全虚拟化吗？ </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#4 class=md-nav__link> <span class=md-ellipsis> 4. 参考材料 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> 操作系统 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> 操作系统 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../os/linux/ class=md-nav__link> <span class=md-ellipsis> Linux </span> </a> </li> <li class=md-nav__item> <a href=../os/rtos/ class=md-nav__link> <span class=md-ellipsis> RTOS </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> 编程语言 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> 编程语言 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../programming_language/c%2B%2B/ class=md-nav__link> <span class=md-ellipsis> C/C++ </span> </a> </li> <li class=md-nav__item> <a href=../programming_language/python/ class=md-nav__link> <span class=md-ellipsis> python </span> </a> </li> <li class=md-nav__item> <a href=../programming_language/shell/ class=md-nav__link> <span class=md-ellipsis> Shell </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#0 class=md-nav__link> <span class=md-ellipsis> 0. 引言 </span> </a> </li> <li class=md-nav__item> <a href=#1 class=md-nav__link> <span class=md-ellipsis> 1. 环境部署 </span> </a> </li> <li class=md-nav__item> <a href=#2-qemu class=md-nav__link> <span class=md-ellipsis> 2. Qemu使用手册 </span> </a> <nav class=md-nav aria-label="2. Qemu使用手册"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#21-qemu class=md-nav__link> <span class=md-ellipsis> 2.1. QEMU 命令详解 </span> </a> <nav class=md-nav aria-label="2.1. QEMU 命令详解"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#211-qemu-system- class=md-nav__link> <span class=md-ellipsis> 2.1.1. qemu-system-[目标机器架构] </span> </a> </li> <li class=md-nav__item> <a href=#212-qemu-cpu class=md-nav__link> <span class=md-ellipsis> 2.1.2. qemu-[CPU 架构] </span> </a> </li> <li class=md-nav__item> <a href=#213-qemu-img class=md-nav__link> <span class=md-ellipsis> 2.1.3. qemu-img </span> </a> </li> <li class=md-nav__item> <a href=#214-qemu-store-daemon class=md-nav__link> <span class=md-ellipsis> 2.1.4. qemu-store-daemon </span> </a> </li> <li class=md-nav__item> <a href=#215-qemu-nbd class=md-nav__link> <span class=md-ellipsis> 2.1.5. qemu-nbd </span> </a> </li> <li class=md-nav__item> <a href=#216-qemu-pr-helper class=md-nav__link> <span class=md-ellipsis> 2.1.6. qemu-pr-helper </span> </a> </li> <li class=md-nav__item> <a href=#217-qemu-trace-stap class=md-nav__link> <span class=md-ellipsis> 2.1.7. qemu-trace-stap </span> </a> </li> <li class=md-nav__item> <a href=#218-virtfs-proxy-helper class=md-nav__link> <span class=md-ellipsis> 2.1.8. virtfs-proxy-helper </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#22-qemu class=md-nav__link> <span class=md-ellipsis> 2.2. QEMU编译测试框架 </span> </a> <nav class=md-nav aria-label="2.2. QEMU编译测试框架"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#221-qemu class=md-nav__link> <span class=md-ellipsis> 2.2.1. QEMU编译框架 </span> </a> <nav class=md-nav aria-label="2.2.1. QEMU编译框架"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2211-configure class=md-nav__link> <span class=md-ellipsis> 2.2.1.1. configure </span> </a> </li> <li class=md-nav__item> <a href=#2212-meson class=md-nav__link> <span class=md-ellipsis> 2.2.1.2. Meson </span> </a> </li> <li class=md-nav__item> <a href=#2213-make class=md-nav__link> <span class=md-ellipsis> 2.2.1.3. Make </span> </a> </li> <li class=md-nav__item> <a href=#2214-important-files-for-the-build-system class=md-nav__link> <span class=md-ellipsis> 2.2.1.4. Important files for the build system </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#222-qemu-and-kconfig class=md-nav__link> <span class=md-ellipsis> 2.2.2. QEMU and Kconfig </span> </a> <nav class=md-nav aria-label="2.2.2. QEMU and Kconfig"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2221-the-kconfig-language class=md-nav__link> <span class=md-ellipsis> 2.2.2.1. The Kconfig language </span> </a> </li> <li class=md-nav__item> <a href=#2222-guidelines-for-writing-kconfig-files class=md-nav__link> <span class=md-ellipsis> 2.2.2.2. Guidelines for writing Kconfig files </span> </a> </li> <li class=md-nav__item> <a href=#2223-writing-and-modifying-default-configurations class=md-nav__link> <span class=md-ellipsis> 2.2.2.3. Writing and modifying default configurations </span> </a> </li> <li class=md-nav__item> <a href=#2224-kconfighost class=md-nav__link> <span class=md-ellipsis> 2.2.2.4. Kconfig.host </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#223-qemu-documentation class=md-nav__link> <span class=md-ellipsis> 2.2.3. QEMU Documentation </span> </a> <nav class=md-nav aria-label="2.2.3. QEMU Documentation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2231-xtool-and-hx-files class=md-nav__link> <span class=md-ellipsis> 2.2.3.1. xtool and .hx files </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#224-testing-in-qemu class=md-nav__link> <span class=md-ellipsis> 2.2.4. Testing in QEMU </span> </a> <nav class=md-nav aria-label="2.2.4. Testing in QEMU"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2241-testing-with-make-check class=md-nav__link> <span class=md-ellipsis> 2.2.4.1. Testing with "make check" </span> </a> </li> <li class=md-nav__item> <a href=#2242-qemu-iotests class=md-nav__link> <span class=md-ellipsis> 2.2.4.2. QEMU iotests </span> </a> </li> <li class=md-nav__item> <a href=#2243-container-based-tests class=md-nav__link> <span class=md-ellipsis> 2.2.4.3. Container based tests </span> </a> </li> <li class=md-nav__item> <a href=#2244-thread-sanitizer class=md-nav__link> <span class=md-ellipsis> 2.2.4.4. Thread Sanitizer </span> </a> </li> <li class=md-nav__item> <a href=#2245-docker-binfmt-image-debian-targets class=md-nav__link> <span class=md-ellipsis> 2.2.4.5. docker-binfmt-image-debian-% targets </span> </a> </li> <li class=md-nav__item> <a href=#2246-vm-testing class=md-nav__link> <span class=md-ellipsis> 2.2.4.6. VM testing </span> </a> </li> <li class=md-nav__item> <a href=#2247-image-fuzzer-testing class=md-nav__link> <span class=md-ellipsis> 2.2.4.7. Image fuzzer testing </span> </a> </li> <li class=md-nav__item> <a href=#2248-integration-tests-using-the-avocado-framework class=md-nav__link> <span class=md-ellipsis> 2.2.4.8. Integration tests using the Avocado Framework </span> </a> </li> <li class=md-nav__item> <a href=#2249-testing-with-make-check-tcg class=md-nav__link> <span class=md-ellipsis> 2.2.4.9. Testing with "make check-tcg" </span> </a> </li> <li class=md-nav__item> <a href=#22410-other-tcg-tests class=md-nav__link> <span class=md-ellipsis> 2.2.4.10. Other TCG Tests </span> </a> </li> <li class=md-nav__item> <a href=#22411-gcc-gcov-support class=md-nav__link> <span class=md-ellipsis> 2.2.4.11. GCC gcov support </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#225-acpismbios-avocado-tests-using-biosbits class=md-nav__link> <span class=md-ellipsis> 2.2.5. ACPI/SMBIOS avocado tests using biosbits </span> </a> <nav class=md-nav aria-label="2.2.5. ACPI/SMBIOS avocado tests using biosbits"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2251-references class=md-nav__link> <span class=md-ellipsis> 2.2.5.1. References </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#226-qtest-device-emulation-testing-framework class=md-nav__link> <span class=md-ellipsis> 2.2.6. QTest Device Emulation Testing Framework </span> </a> <nav class=md-nav aria-label="2.2.6. QTest Device Emulation Testing Framework"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2261-qtest-driver-framework class=md-nav__link> <span class=md-ellipsis> 2.2.6.1. Qtest Driver Framework </span> </a> </li> <li class=md-nav__item> <a href=#2262-qtest-protocol class=md-nav__link> <span class=md-ellipsis> 2.2.6.2. QTest Protocol </span> </a> </li> <li class=md-nav__item> <a href=#2263-libqtest-api-reference class=md-nav__link> <span class=md-ellipsis> 2.2.6.3. libqtest API reference </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#227-ci class=md-nav__link> <span class=md-ellipsis> 2.2.7. CI </span> </a> <nav class=md-nav aria-label="2.2.7. CI"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2271-definition-of-terms class=md-nav__link> <span class=md-ellipsis> 2.2.7.1. Definition of terms </span> </a> </li> <li class=md-nav__item> <a href=#2272-custom-cicd-variables class=md-nav__link> <span class=md-ellipsis> 2.2.7.2. Custom CI/CD variables </span> </a> </li> <li class=md-nav__item> <a href=#2273-jobs-on-custom-runners class=md-nav__link> <span class=md-ellipsis> 2.2.7.3. Jobs on Custom Runners </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#228-how-to-use-the-qapi-code-generator class=md-nav__link> <span class=md-ellipsis> 2.2.8. How to use the QAPI code generator </span> </a> <nav class=md-nav aria-label="2.2.8. How to use the QAPI code generator"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2281-introduction class=md-nav__link> <span class=md-ellipsis> 2.2.8.1. Introduction </span> </a> </li> <li class=md-nav__item> <a href=#2282-the-qapi-schema-language class=md-nav__link> <span class=md-ellipsis> 2.2.8.2. The QAPI schema language </span> </a> </li> <li class=md-nav__item> <a href=#2283-client-json-protocol-introspection class=md-nav__link> <span class=md-ellipsis> 2.2.8.3. Client JSON Protocol introspection </span> </a> </li> <li class=md-nav__item> <a href=#2284-compatibility-considerations class=md-nav__link> <span class=md-ellipsis> 2.2.8.4. Compatibility considerations </span> </a> </li> <li class=md-nav__item> <a href=#2285-code-generation class=md-nav__link> <span class=md-ellipsis> 2.2.8.5. Code generation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#229-fuzzing class=md-nav__link> <span class=md-ellipsis> 2.2.9. Fuzzing </span> </a> <nav class=md-nav aria-label="2.2.9. Fuzzing"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2291-basics class=md-nav__link> <span class=md-ellipsis> 2.2.9.1. Basics </span> </a> </li> <li class=md-nav__item> <a href=#2292-building-the-fuzzers class=md-nav__link> <span class=md-ellipsis> 2.2.9.2. Building the fuzzers </span> </a> </li> <li class=md-nav__item> <a href=#2293-useful-libfuzzer-flags class=md-nav__link> <span class=md-ellipsis> 2.2.9.3. Useful libFuzzer flags </span> </a> </li> <li class=md-nav__item> <a href=#2294-generating-coverage-reports class=md-nav__link> <span class=md-ellipsis> 2.2.9.4. Generating Coverage Reports </span> </a> </li> <li class=md-nav__item> <a href=#2295-adding-a-new-fuzzer class=md-nav__link> <span class=md-ellipsis> 2.2.9.5. Adding a new fuzzer </span> </a> </li> <li class=md-nav__item> <a href=#2296-the-generic-fuzzer class=md-nav__link> <span class=md-ellipsis> 2.2.9.6. The Generic Fuzzer </span> </a> </li> <li class=md-nav__item> <a href=#2297-oss-fuzz class=md-nav__link> <span class=md-ellipsis> 2.2.9.7. OSS-Fuzz </span> </a> </li> <li class=md-nav__item> <a href=#2298-building-crash-reproducers class=md-nav__link> <span class=md-ellipsis> 2.2.9.8. Building Crash Reproducers </span> </a> </li> <li class=md-nav__item> <a href=#2299-implementation-details-fuzzer-lifecycle class=md-nav__link> <span class=md-ellipsis> 2.2.9.9. Implementation Details / Fuzzer Lifecycle </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2210-control-flow-integrity-cfi class=md-nav__link> <span class=md-ellipsis> 2.2.10. Control-Flow Integrity (CFI) </span> </a> <nav class=md-nav aria-label="2.2.10. Control-Flow Integrity (CFI)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#22101-basics class=md-nav__link> <span class=md-ellipsis> 2.2.10.1. Basics </span> </a> </li> <li class=md-nav__item> <a href=#22102-building-with-cfi class=md-nav__link> <span class=md-ellipsis> 2.2.10.2. Building with CFI </span> </a> </li> <li class=md-nav__item> <a href=#22103-using-qemu-built-with-cfi class=md-nav__link> <span class=md-ellipsis> 2.2.10.3. Using QEMU built with CFI </span> </a> </li> <li class=md-nav__item> <a href=#22104-incompatible-code-with-cfi class=md-nav__link> <span class=md-ellipsis> 2.2.10.4. Incompatible code with CFI </span> </a> </li> <li class=md-nav__item> <a href=#22105-disabling-cfi-for-a-specific-function class=md-nav__link> <span class=md-ellipsis> 2.2.10.5. Disabling CFI for a specific function </span> </a> </li> <li class=md-nav__item> <a href=#22106-cfi-and-fuzzing class=md-nav__link> <span class=md-ellipsis> 2.2.10.6. CFI and fuzzing </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#23-qemutcg class=md-nav__link> <span class=md-ellipsis> 2.3. QEMU翻译原理TCG </span> </a> <nav class=md-nav aria-label="2.3. QEMU翻译原理TCG"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#231-translator-internals class=md-nav__link> <span class=md-ellipsis> 2.3.1. Translator Internals </span> </a> <nav class=md-nav aria-label="2.3.1. Translator Internals"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2311-cpu-state-optimisations class=md-nav__link> <span class=md-ellipsis> 2.3.1.1. CPU state optimisations </span> </a> </li> <li class=md-nav__item> <a href=#2312-direct-block-chaining class=md-nav__link> <span class=md-ellipsis> 2.3.1.2. Direct block chaining </span> </a> </li> <li class=md-nav__item> <a href=#2313-self-modifying-code-and-translated-code-invalidation class=md-nav__link> <span class=md-ellipsis> 2.3.1.3. Self-modifying code and translated code invalidation </span> </a> </li> <li class=md-nav__item> <a href=#2314-exception-support class=md-nav__link> <span class=md-ellipsis> 2.3.1.4. Exception support </span> </a> </li> <li class=md-nav__item> <a href=#2315-mmu-emulation class=md-nav__link> <span class=md-ellipsis> 2.3.1.5. MMU emulation </span> </a> </li> <li class=md-nav__item> <a href=#2316-profiling-jitted-code class=md-nav__link> <span class=md-ellipsis> 2.3.1.6. Profiling JITted code </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#232-tcg-intermediate-representation class=md-nav__link> <span class=md-ellipsis> 2.3.2. TCG Intermediate Representation </span> </a> <nav class=md-nav aria-label="2.3.2. TCG Intermediate Representation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2321-introduction class=md-nav__link> <span class=md-ellipsis> 2.3.2.1. Introduction </span> </a> </li> <li class=md-nav__item> <a href=#2322-definitions class=md-nav__link> <span class=md-ellipsis> 2.3.2.2. Definitions </span> </a> </li> <li class=md-nav__item> <a href=#2323-basic-blocks class=md-nav__link> <span class=md-ellipsis> 2.3.2.3. Basic Blocks </span> </a> </li> <li class=md-nav__item> <a href=#2324-operations class=md-nav__link> <span class=md-ellipsis> 2.3.2.4. Operations </span> </a> </li> <li class=md-nav__item> <a href=#2325-variables class=md-nav__link> <span class=md-ellipsis> 2.3.2.5. Variables </span> </a> </li> <li class=md-nav__item> <a href=#2326-types class=md-nav__link> <span class=md-ellipsis> 2.3.2.6. Types </span> </a> </li> <li class=md-nav__item> <a href=#2327-helpers class=md-nav__link> <span class=md-ellipsis> 2.3.2.7. Helpers </span> </a> </li> <li class=md-nav__item> <a href=#2328-code-optimizations class=md-nav__link> <span class=md-ellipsis> 2.3.2.8. Code Optimizations </span> </a> </li> <li class=md-nav__item> <a href=#2329-instruction-reference class=md-nav__link> <span class=md-ellipsis> 2.3.2.9. Instruction Reference </span> </a> </li> <li class=md-nav__item> <a href=#23210-backend class=md-nav__link> <span class=md-ellipsis> 2.3.2.10. Backend </span> </a> </li> <li class=md-nav__item> <a href=#23211-recommended-coding-rules-for-best-performance class=md-nav__link> <span class=md-ellipsis> 2.3.2.11. Recommended coding rules for best performance </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#233-decodetree-specification class=md-nav__link> <span class=md-ellipsis> 2.3.3. Decodetree Specification </span> </a> <nav class=md-nav aria-label="2.3.3. Decodetree Specification"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2331-fields class=md-nav__link> <span class=md-ellipsis> 2.3.3.1. Fields </span> </a> </li> <li class=md-nav__item> <a href=#2332-argument-sets class=md-nav__link> <span class=md-ellipsis> 2.3.3.2. Argument Sets </span> </a> </li> <li class=md-nav__item> <a href=#2333-formats class=md-nav__link> <span class=md-ellipsis> 2.3.3.3. Formats </span> </a> </li> <li class=md-nav__item> <a href=#2334-patterns class=md-nav__link> <span class=md-ellipsis> 2.3.3.4. Patterns </span> </a> </li> <li class=md-nav__item> <a href=#2335-pattern-groups class=md-nav__link> <span class=md-ellipsis> 2.3.3.5. Pattern Groups </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#234-multi-threaded-tcg class=md-nav__link> <span class=md-ellipsis> 2.3.4. Multi-threaded TCG </span> </a> <nav class=md-nav aria-label="2.3.4. Multi-threaded TCG"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2341-vcpu-scheduling class=md-nav__link> <span class=md-ellipsis> 2.3.4.1. vCPU Scheduling </span> </a> </li> <li class=md-nav__item> <a href=#2342-shared-data-structures class=md-nav__link> <span class=md-ellipsis> 2.3.4.2. Shared Data Structures </span> </a> </li> <li class=md-nav__item> <a href=#2343-memory-consistency class=md-nav__link> <span class=md-ellipsis> 2.3.4.3. Memory Consistency </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#235-tcg-instruction-counting class=md-nav__link> <span class=md-ellipsis> 2.3.5. TCG Instruction Counting </span> </a> <nav class=md-nav aria-label="2.3.5. TCG Instruction Counting"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2351-core-concepts class=md-nav__link> <span class=md-ellipsis> 2.3.5.1. Core Concepts </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#236-qemu-tcg-plugins class=md-nav__link> <span class=md-ellipsis> 2.3.6. QEMU TCG Plugins </span> </a> <nav class=md-nav aria-label="2.3.6. QEMU TCG Plugins"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2361-usage class=md-nav__link> <span class=md-ellipsis> 2.3.6.1. Usage </span> </a> </li> <li class=md-nav__item> <a href=#2362-writing-plugins class=md-nav__link> <span class=md-ellipsis> 2.3.6.2. Writing plugins </span> </a> </li> <li class=md-nav__item> <a href=#2363-internals class=md-nav__link> <span class=md-ellipsis> 2.3.6.3. Internals </span> </a> </li> <li class=md-nav__item> <a href=#2364-example-plugins class=md-nav__link> <span class=md-ellipsis> 2.3.6.4. Example Plugins </span> </a> </li> <li class=md-nav__item> <a href=#2365-api class=md-nav__link> <span class=md-ellipsis> 2.3.6.5. API </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#237-execution-recordreplay class=md-nav__link> <span class=md-ellipsis> 2.3.7. Execution Record/Replay </span> </a> <nav class=md-nav aria-label="2.3.7. Execution Record/Replay"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2371-core-concepts class=md-nav__link> <span class=md-ellipsis> 2.3.7.1. Core concepts </span> </a> </li> <li class=md-nav__item> <a href=#2372-virtual-devices class=md-nav__link> <span class=md-ellipsis> 2.3.7.2. Virtual devices </span> </a> </li> <li class=md-nav__item> <a href=#2373-replay-log-format class=md-nav__link> <span class=md-ellipsis> 2.3.7.3. Replay log format </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#24-qemu class=md-nav__link> <span class=md-ellipsis> 2.4. QEMU 子模块 </span> </a> <nav class=md-nav aria-label="2.4. QEMU 子模块"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#241-the-qemu-object-model-qom class=md-nav__link> <span class=md-ellipsis> 2.4.1. The QEMU Object Model (QOM) </span> </a> <nav class=md-nav aria-label="2.4.1. The QEMU Object Model (QOM)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2411-the-qom-tree class=md-nav__link> <span class=md-ellipsis> 2.4.1.1. The QOM tree </span> </a> </li> <li class=md-nav__item> <a href=#2412-creating-a-qom-class class=md-nav__link> <span class=md-ellipsis> 2.4.1.2. Creating a QOM class </span> </a> </li> <li class=md-nav__item> <a href=#2413-standard-type-declaration-and-definition-macros class=md-nav__link> <span class=md-ellipsis> 2.4.1.3. Standard type declaration and definition macros </span> </a> </li> <li class=md-nav__item> <a href=#2414-device-life-cycle class=md-nav__link> <span class=md-ellipsis> 2.4.1.4. Device Life-cycle </span> </a> </li> <li class=md-nav__item> <a href=#2415-api-reference class=md-nav__link> <span class=md-ellipsis> 2.4.1.5. API Reference </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#242-atomic-operations-in-qemu class=md-nav__link> <span class=md-ellipsis> 2.4.2. Atomic operations in QEMU </span> </a> <nav class=md-nav aria-label="2.4.2. Atomic operations in QEMU"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2421-compiler-memory-barrier class=md-nav__link> <span class=md-ellipsis> 2.4.2.1. Compiler memory barrier </span> </a> </li> <li class=md-nav__item> <a href=#2422-sequentially-consistent-atomic-access class=md-nav__link> <span class=md-ellipsis> 2.4.2.2. Sequentially consistent atomic access </span> </a> </li> <li class=md-nav__item> <a href=#2423-weak-atomic-access-and-manual-memory-barriers class=md-nav__link> <span class=md-ellipsis> 2.4.2.3. Weak atomic access and manual memory barriers </span> </a> </li> <li class=md-nav__item> <a href=#2424-comparison-with-linux-kernel-primitives class=md-nav__link> <span class=md-ellipsis> 2.4.2.4. Comparison with Linux kernel primitives </span> </a> </li> <li class=md-nav__item> <a href=#2425-sources class=md-nav__link> <span class=md-ellipsis> 2.4.2.5. Sources </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#243-block-coroutine-wrapper class=md-nav__link> <span class=md-ellipsis> 2.4.3. block-coroutine-wrapper </span> </a> <nav class=md-nav aria-label="2.4.3. block-coroutine-wrapper"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2431-usage class=md-nav__link> <span class=md-ellipsis> 2.4.3.1. Usage </span> </a> </li> <li class=md-nav__item> <a href=#2432-links class=md-nav__link> <span class=md-ellipsis> 2.4.3.2. Links </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#244-modelling-a-clock-tree-in-qemu class=md-nav__link> <span class=md-ellipsis> 2.4.4. Modelling a clock tree in QEMU </span> </a> <nav class=md-nav aria-label="2.4.4. Modelling a clock tree in QEMU"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2441-what-are-clocks class=md-nav__link> <span class=md-ellipsis> 2.4.4.1. What are clocks? </span> </a> </li> <li class=md-nav__item> <a href=#2442-the-clock-state class=md-nav__link> <span class=md-ellipsis> 2.4.4.2. The clock state </span> </a> </li> <li class=md-nav__item> <a href=#2443-adding-a-new-clock class=md-nav__link> <span class=md-ellipsis> 2.4.4.3. Adding a new clock </span> </a> </li> <li class=md-nav__item> <a href=#2444-clock-callbacks class=md-nav__link> <span class=md-ellipsis> 2.4.4.4. Clock callbacks </span> </a> </li> <li class=md-nav__item> <a href=#2445-retrieving-clocks-from-a-device class=md-nav__link> <span class=md-ellipsis> 2.4.4.5. Retrieving clocks from a device </span> </a> </li> <li class=md-nav__item> <a href=#2446-connecting-two-clocks-together class=md-nav__link> <span class=md-ellipsis> 2.4.4.6. Connecting two clocks together </span> </a> </li> <li class=md-nav__item> <a href=#2447-clock-multiplier-and-divider-settings class=md-nav__link> <span class=md-ellipsis> 2.4.4.7. Clock multiplier and divider settings </span> </a> </li> <li class=md-nav__item> <a href=#2448-unconnected-input-clocks class=md-nav__link> <span class=md-ellipsis> 2.4.4.8. Unconnected input clocks </span> </a> </li> <li class=md-nav__item> <a href=#2449-fetching-clock-frequencyperiod class=md-nav__link> <span class=md-ellipsis> 2.4.4.9. Fetching clock frequency/period </span> </a> </li> <li class=md-nav__item> <a href=#24410-calculating-expiry-deadlines class=md-nav__link> <span class=md-ellipsis> 2.4.4.10. Calculating expiry deadlines </span> </a> </li> <li class=md-nav__item> <a href=#24411-obtaining-tick-counts class=md-nav__link> <span class=md-ellipsis> 2.4.4.11. Obtaining tick counts </span> </a> </li> <li class=md-nav__item> <a href=#24412-changing-a-clock-period class=md-nav__link> <span class=md-ellipsis> 2.4.4.12. Changing a clock period </span> </a> </li> <li class=md-nav__item> <a href=#24413-aliasing-clocks class=md-nav__link> <span class=md-ellipsis> 2.4.4.13. Aliasing clocks </span> </a> </li> <li class=md-nav__item> <a href=#24414-migration class=md-nav__link> <span class=md-ellipsis> 2.4.4.14. Migration </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#245-ebpf-rss-virtio-net-support class=md-nav__link> <span class=md-ellipsis> 2.4.5. eBPF RSS virtio-net support </span> </a> <nav class=md-nav aria-label="2.4.5. eBPF RSS virtio-net support"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2451-rss-ebpf-program class=md-nav__link> <span class=md-ellipsis> 2.4.5.1. RSS eBPF program </span> </a> </li> <li class=md-nav__item> <a href=#2452-ebpf-rss-implementation class=md-nav__link> <span class=md-ellipsis> 2.4.5.2. eBPF RSS implementation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#246-migration class=md-nav__link> <span class=md-ellipsis> 2.4.6. Migration </span> </a> <nav class=md-nav aria-label="2.4.6. Migration"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2461-migration-framework class=md-nav__link> <span class=md-ellipsis> 2.4.6.1. Migration framework </span> </a> </li> <li class=md-nav__item> <a href=#2462-migration-features class=md-nav__link> <span class=md-ellipsis> 2.4.6.2. Migration features </span> </a> </li> <li class=md-nav__item> <a href=#2463-backwards-compatibility class=md-nav__link> <span class=md-ellipsis> 2.4.6.3. Backwards compatibility </span> </a> </li> <li class=md-nav__item> <a href=#2464-best-practices class=md-nav__link> <span class=md-ellipsis> 2.4.6.4. Best practices </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#247-multi-process-qemu class=md-nav__link> <span class=md-ellipsis> 2.4.7. Multi-process QEMU </span> </a> <nav class=md-nav aria-label="2.4.7. Multi-process QEMU"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2471-qemu-services class=md-nav__link> <span class=md-ellipsis> 2.4.7.1. QEMU services </span> </a> </li> <li class=md-nav__item> <a href=#2472-separating-io-services class=md-nav__link> <span class=md-ellipsis> 2.4.7.2. Separating IO services </span> </a> </li> <li class=md-nav__item> <a href=#2473-new-separation-model-based-on-proxy-objects class=md-nav__link> <span class=md-ellipsis> 2.4.7.3. New separation model based on proxy objects </span> </a> </li> <li class=md-nav__item> <a href=#2474-disaggregated-cpu-emulation class=md-nav__link> <span class=md-ellipsis> 2.4.7.4. Disaggregated CPU emulation </span> </a> </li> <li class=md-nav__item> <a href=#2475-host-access-controls class=md-nav__link> <span class=md-ellipsis> 2.4.7.5. Host access controls </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#248-reset-in-qemu-the-resettable-interface class=md-nav__link> <span class=md-ellipsis> 2.4.8. Reset in QEMU: the Resettable interface </span> </a> <nav class=md-nav aria-label="2.4.8. Reset in QEMU: the Resettable interface"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2481-triggering-reset class=md-nav__link> <span class=md-ellipsis> 2.4.8.1. Triggering reset </span> </a> </li> <li class=md-nav__item> <a href=#2482-multi-phase-mechanism class=md-nav__link> <span class=md-ellipsis> 2.4.8.2. Multi-phase mechanism </span> </a> </li> <li class=md-nav__item> <a href=#2483-handling-reset-in-a-resettable-object class=md-nav__link> <span class=md-ellipsis> 2.4.8.3. Handling reset in a resettable object </span> </a> </li> <li class=md-nav__item> <a href=#2484-base-class-handling-of-reset class=md-nav__link> <span class=md-ellipsis> 2.4.8.4. Base class handling of reset </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#249-qapi-interface-for-s390-cpu-topology class=md-nav__link> <span class=md-ellipsis> 2.4.9. QAPI interface for S390 CPU topology </span> </a> <nav class=md-nav aria-label="2.4.9. QAPI interface for S390 CPU topology"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#2491-additions-to-query-cpus-fast class=md-nav__link> <span class=md-ellipsis> 2.4.9.1. Additions to query-cpus-fast </span> </a> </li> <li class=md-nav__item> <a href=#2492-qapi-command-set-cpu-topology class=md-nav__link> <span class=md-ellipsis> 2.4.9.2. QAPI command: set-cpu-topology </span> </a> </li> <li class=md-nav__item> <a href=#2493-qapi-event-cpu_polarization_change class=md-nav__link> <span class=md-ellipsis> 2.4.9.3. QAPI event CPU_POLARIZATION_CHANGE </span> </a> </li> <li class=md-nav__item> <a href=#2494-qapi-query-command-query-s390x-cpu-polarization class=md-nav__link> <span class=md-ellipsis> 2.4.9.4. QAPI query command: query-s390x-cpu-polarization </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2410-booting-from-real-channel-attached-devices-on-s390x class=md-nav__link> <span class=md-ellipsis> 2.4.10. Booting from real channel-attached devices on s390x </span> </a> <nav class=md-nav aria-label="2.4.10. Booting from real channel-attached devices on s390x"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#24101-s390-hardware-ipl class=md-nav__link> <span class=md-ellipsis> 2.4.10.1. s390 hardware IPL </span> </a> </li> <li class=md-nav__item> <a href=#24102-how-this-all-pertains-to-qemu-and-the-kernel class=md-nav__link> <span class=md-ellipsis> 2.4.10.2. How this all pertains to QEMU (and the kernel) </span> </a> </li> <li class=md-nav__item> <a href=#24103-what-qemu-does class=md-nav__link> <span class=md-ellipsis> 2.4.10.3. What QEMU does </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2411-tracing class=md-nav__link> <span class=md-ellipsis> 2.4.11. Tracing </span> </a> <nav class=md-nav aria-label="2.4.11. Tracing"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#24111-introduction class=md-nav__link> <span class=md-ellipsis> 2.4.11.1. Introduction </span> </a> </li> <li class=md-nav__item> <a href=#24112-quickstart class=md-nav__link> <span class=md-ellipsis> 2.4.11.2. Quickstart </span> </a> </li> <li class=md-nav__item> <a href=#24113-trace-events class=md-nav__link> <span class=md-ellipsis> 2.4.11.3. Trace events </span> </a> </li> <li class=md-nav__item> <a href=#24114-generic-interface-and-monitor-commands class=md-nav__link> <span class=md-ellipsis> 2.4.11.4. Generic interface and monitor commands </span> </a> </li> <li class=md-nav__item> <a href=#24115-trace-backends class=md-nav__link> <span class=md-ellipsis> 2.4.11.5. Trace backends </span> </a> </li> <li class=md-nav__item> <a href=#24116-trace-event-properties class=md-nav__link> <span class=md-ellipsis> 2.4.11.6. Trace event properties </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2412-iommufd-backend-usage-with-vfio class=md-nav__link> <span class=md-ellipsis> 2.4.12. IOMMUFD BACKEND usage with VFIO </span> </a> <nav class=md-nav aria-label="2.4.12. IOMMUFD BACKEND usage with VFIO"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#24121-example-configuration class=md-nav__link> <span class=md-ellipsis> 2.4.12.1. Example configuration </span> </a> </li> <li class=md-nav__item> <a href=#24122-supported-platform class=md-nav__link> <span class=md-ellipsis> 2.4.12.2. Supported platform </span> </a> </li> <li class=md-nav__item> <a href=#24123-caveats class=md-nav__link> <span class=md-ellipsis> 2.4.12.3. Caveats </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2413-how-to-write-monitor-commands class=md-nav__link> <span class=md-ellipsis> 2.4.13. How to write monitor commands </span> </a> <nav class=md-nav aria-label="2.4.13. How to write monitor commands"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#24131-overview class=md-nav__link> <span class=md-ellipsis> 2.4.13.1. Overview </span> </a> </li> <li class=md-nav__item> <a href=#24132-testing class=md-nav__link> <span class=md-ellipsis> 2.4.13.2. Testing </span> </a> </li> <li class=md-nav__item> <a href=#24133-writing-a-simple-command-hello-world class=md-nav__link> <span class=md-ellipsis> 2.4.13.3. Writing a simple command: hello-world </span> </a> </li> <li class=md-nav__item> <a href=#24134-writing-more-complex-commands class=md-nav__link> <span class=md-ellipsis> 2.4.13.4. Writing more complex commands </span> </a> </li> <li class=md-nav__item> <a href=#24135-writing-a-debugging-aid-returning-unstructured-text class=md-nav__link> <span class=md-ellipsis> 2.4.13.5. Writing a debugging aid returning unstructured text </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2414-writing-virtio-backends-for-qemu class=md-nav__link> <span class=md-ellipsis> 2.4.14. Writing VirtIO backends for QEMU </span> </a> <nav class=md-nav aria-label="2.4.14. Writing VirtIO backends for QEMU"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#24141-virtio-transports class=md-nav__link> <span class=md-ellipsis> 2.4.14.1. VirtIO Transports </span> </a> </li> <li class=md-nav__item> <a href=#24142-using-the-qemu-object-model-qom class=md-nav__link> <span class=md-ellipsis> 2.4.14.2. Using the QEMU Object Model (QOM) </span> </a> </li> <li class=md-nav__item> <a href=#24143-back-end-implementations class=md-nav__link> <span class=md-ellipsis> 2.4.14.3. Back End Implementations </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#25-qemu class=md-nav__link> <span class=md-ellipsis> 2.5. QEMU 目录结构 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#3 class=md-nav__link> <span class=md-ellipsis> 3. 笔记 </span> </a> <nav class=md-nav aria-label="3. 笔记"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#31 class=md-nav__link> <span class=md-ellipsis> 3.1. 虚拟化是什么？ </span> </a> </li> <li class=md-nav__item> <a href=#32-qemu class=md-nav__link> <span class=md-ellipsis> 3.2. Qemu是全虚拟化吗？ </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#4 class=md-nav__link> <span class=md-ellipsis> 4. 参考材料 </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=qemu>QEMU<a class=headerlink href=#qemu title="Permanent link">&para;</a></h1> <hr> <h2 id=0>0. 引言<a class=headerlink href=#0 title="Permanent link">&para;</a></h2> <ul class=task-list> <li class=task-list-item> <p><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> 当使用QEMU（Quick EMUlator）进行SOC芯片的仿真时，需要解决以下详细问题：</p> </li> <li> <p>系统模拟问题：</p> </li> <li>确定仿真的SOC芯片型号和架构，选择合适的处理器模型（比如ARM Cortex-A系列、RISC-V等）。</li> <li>配置内存模型，包括地址空间分布、内存映射等，确保仿真时能够正确访问内存。</li> <li> <p>设置外设模型，如串口、网卡、存储控制器等，以便于仿真SOC芯片与外部设备的交互。</p> </li> <li> <p>时序精度问题：</p> </li> <li>确定仿真中的时钟频率和时序参数，保证仿真过程中的时序准确性。</li> <li> <p>考虑时钟域之间的同步和延迟，确保各个模块按照正确的时序顺序工作。</p> </li> <li> <p>调试问题：</p> </li> <li>提供调试接口，如GDB调试器的集成，以便于开发人员对仿真SOC芯片进行代码调试和性能分析。</li> <li> <p>支持断点、单步执行等调试功能，帮助开发人员快速定位问题并进行调试修复。</p> </li> <li> <p>性能问题：</p> </li> <li>优化QEMU的性能，包括指令级模拟、JIT编译器等技术，提高仿真速度和效率。</li> <li> <p>考虑仿真过程中的资源占用情况，以及与宿主机器的资源管理，确保仿真过程不会占用过多的计算资源。</p> </li> <li> <p>兼容性问题：</p> </li> <li>确保SOC芯片的仿真可以运行不同的操作系统，如Linux、RTOS等，验证软件的兼容性。</li> <li>模拟各种外部设备和接口，确保仿真环境与真实硬件环境的兼容性，保证软件在不同平台上的正常运行。</li> </ul> <h2 id=1>1. 环境部署<a class=headerlink href=#1 title="Permanent link">&para;</a></h2> <h2 id=2-qemu>2. Qemu使用手册<a class=headerlink href=#2-qemu title="Permanent link">&para;</a></h2> <h3 id=21-qemu>2.1. QEMU 命令详解<a class=headerlink href=#21-qemu title="Permanent link">&para;</a></h3> <h4 id=211-qemu-system->2.1.1. qemu-system-[目标机器架构]<a class=headerlink href=#211-qemu-system- title="Permanent link">&para;</a></h4> <p>QEMU 系统模式</p> <ul> <li>在该模式下, QEMU 将会模拟一个完整的系统，<code>包含一个或多个处理器以及各种外围设备</code>。这种模式更加贴近真实的系统，且这种模式不要求被模拟的客户机系统是 Linux，但它的速度较慢。</li> <li>QEMU 中启用 full-system 模式的命令依照如下规则进行命名 <code>qemu-system-目标机器架构</code>，例如 qemu-system-x86_64 用于模拟 x86_64 架构 CPU, qemu-system-i386 模拟 Intel 32位 x86 架构 CPU， qemu-system-arm 模拟 32 位 ARM 架构，qemu-system-aarch64 模拟 64 位 ARM 架构，等等。</li> <li>如果模拟的 CPU 架构与宿主机的 CPU 架构相同, 那么即使在此模式下，QEMU 仍有可能使用 hypervisor（<code>例如KVM 或者 Xen</code>）的技术对模拟机进行加速。</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>qemu-system-<span class=o>{{</span>目标机器架构<span class=o>}}</span><span class=w> </span><span class=o>[</span>machine<span class=w> </span>opts<span class=o>]</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=w>                </span><span class=o>[</span>cpu<span class=w> </span>opts<span class=o>]</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=w>                </span><span class=o>[</span>accelerator<span class=w> </span>opts<span class=o>]</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=w>                </span><span class=o>[</span>device<span class=w> </span>opts<span class=o>]</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=w>                </span><span class=o>[</span>backend<span class=w> </span>opts<span class=o>]</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=w>                </span><span class=o>[</span>interface<span class=w> </span>opts<span class=o>]</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=w>                </span><span class=o>[</span>boot<span class=w> </span>opts<span class=o>]</span>
</code></pre></div> <table> <thead> <tr> <th style="text-align: center;">option</th> <th style="text-align: left;">content</th> </tr> </thead> <tbody> <tr> <td style="text-align: center;">Machine</td> <td style="text-align: left;">Define the machine type, amount of memory etc.</td> </tr> <tr> <td style="text-align: center;">CPU</td> <td style="text-align: left;">Type and number/topology of vCPUs. Most accelerators offer a cpu option which simply passes through your host CPU configuration without filtering out any features.host</td> </tr> <tr> <td style="text-align: center;">Accelerator</td> <td style="text-align: left;">This will depend on the hypervisor you run. Note that the default is TCG, which is purely emulated, so you must specify an accelerator type to take advantage of hardware virtualization.</td> </tr> <tr> <td style="text-align: center;">Devices</td> <td style="text-align: left;">Additional devices that are not defined by default with the machine type.</td> </tr> <tr> <td style="text-align: center;">Backends</td> <td style="text-align: left;">Backends are how QEMU deals with the guest’s data, for example how a block device is stored, how network devices see the network or how a serial device is directed to the outside world.</td> </tr> <tr> <td style="text-align: center;">Interfaces</td> <td style="text-align: left;">How the system is displayed, how it is managed and controlled or debugged.</td> </tr> <tr> <td style="text-align: center;">Boot</td> <td style="text-align: left;">How the system boots, via firmware or direct kernel boot.</td> </tr> </tbody> </table> <h4 id=212-qemu-cpu>2.1.2. qemu-[CPU 架构]<a class=headerlink href=#212-qemu-cpu title="Permanent link">&para;</a></h4> <p>QEMU 用户模式</p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a>qemu-<span class=o>{{</span>CPU架构<span class=o>}}</span><span class=w> </span><span class=o>[</span>-h<span class=o>]</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=w>            </span><span class=o>[</span>-d<span class=o>]</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=w>            </span><span class=o>[</span>-L<span class=w> </span>path<span class=o>]</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=w>            </span><span class=o>[</span>-s<span class=w> </span>size<span class=o>]</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=w>            </span><span class=o>[</span>-cpu<span class=w> </span>model<span class=o>]</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=w>            </span><span class=o>[</span>-g<span class=w> </span>port<span class=o>]</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=w>            </span><span class=o>[</span>-B<span class=w> </span>offset<span class=o>]</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=w>            </span><span class=o>[</span>-R<span class=w> </span>size<span class=o>]</span><span class=w> </span>program<span class=w> </span><span class=o>[</span>arguments...<span class=o>]</span>
</code></pre></div> <ul> <li> <p>-h</p> <ul> <li>Print the help</li> </ul> </li> <li> <p>-L path</p> <ul> <li>Set the library root path (default=/)</li> </ul> </li> <li> <p>-s size</p> <ul> <li>Set the stack size in bytes (default=524288)</li> </ul> </li> <li> <p>-ignore-environment</p> <ul> <li>Start with an empty environment. Without this option, the initial environment is a copy of the caller’s environment.</li> </ul> </li> <li> <p>-E var=value</p> <ul> <li>Set environment var to value.</li> </ul> </li> <li> <p>-U var</p> <ul> <li>Remove var from the environment.</li> </ul> </li> <li> <p>-bsd type</p> <ul> <li>Set the type of the emulated BSD Operating system. Valid values are FreeBSD, NetBSD and OpenBSD (default).</li> </ul> </li> <li> <p>Debug options:</p> <ul> <li> <p>-d item1,...</p> <ul> <li>Activate logging of the specified items (use ‘-d help’ for a list of log items)</li> </ul> </li> <li> <p>-p pagesize</p> <ul> <li>Act as if the host page size was ‘pagesize’ bytes</li> </ul> </li> <li> <p>-one-insn-per-tb</p> <ul> <li>Run the emulation with one guest instruction per translation block. This slows down emulation a lot, but can be useful in some situations, such as when trying to analyse the logs produced by the -d option.</li> </ul> </li> </ul> </li> </ul> <h4 id=213-qemu-img>2.1.3. qemu-img<a class=headerlink href=#213-qemu-img title="Permanent link">&para;</a></h4> <p>QEMU 磁盘管理工具</p> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a>qemu-img<span class=w> </span><span class=o>[</span>standard<span class=w> </span>options<span class=o>]</span><span class=w> </span><span class=nb>command</span><span class=w> </span><span class=o>[</span><span class=nb>command</span><span class=w> </span>options<span class=o>]</span>
</code></pre></div> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> 命令行解释</li> </ul> <h4 id=214-qemu-store-daemon>2.1.4. qemu-store-daemon<a class=headerlink href=#214-qemu-store-daemon title="Permanent link">&para;</a></h4> <p>qemu-store-daemon 作为一个独立的进程运行，完全不需要任何虚拟机，并提供了以前只在 Qemu 中才可用的 QMP 命令来对磁盘镜像文件进行操作。</p> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a>qemu-storage-daemon<span class=w> </span><span class=o>[</span>options<span class=o>]</span>
</code></pre></div> <h4 id=215-qemu-nbd>2.1.5. qemu-nbd<a class=headerlink href=#215-qemu-nbd title="Permanent link">&para;</a></h4> <p>QEMU Disk Network Block Device Server</p> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a>qemu-nbd<span class=w> </span><span class=o>[</span>OPTION<span class=o>]</span>…<span class=w> </span>filename
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a>qemu-nbd<span class=w> </span>-L<span class=w> </span><span class=o>[</span>OPTION<span class=o>]</span>…
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a>qemu-nbd<span class=w> </span>-d<span class=w> </span>dev
</code></pre></div> <h4 id=216-qemu-pr-helper>2.1.6. qemu-pr-helper<a class=headerlink href=#216-qemu-pr-helper title="Permanent link">&para;</a></h4> <p>QEMU persistent reservation helper</p> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a>qemu-pr-helper<span class=w> </span><span class=o>[</span>OPTION<span class=o>]</span>
</code></pre></div> <h4 id=217-qemu-trace-stap>2.1.7. qemu-trace-stap<a class=headerlink href=#217-qemu-trace-stap title="Permanent link">&para;</a></h4> <p>QEMU SystemTap trace tool</p> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a>qemu-trace-stap<span class=w> </span><span class=o>[</span>GLOBAL-OPTIONS<span class=o>]</span><span class=w> </span>COMMAND<span class=w> </span><span class=o>[</span>COMMAND-OPTIONS<span class=o>]</span><span class=w> </span>ARGS…
</code></pre></div> <h4 id=218-virtfs-proxy-helper>2.1.8. virtfs-proxy-helper<a class=headerlink href=#218-virtfs-proxy-helper title="Permanent link">&para;</a></h4> <p>QEMU 9p virtfs proxy filesystem helper</p> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a>virtfs-proxy-helper<span class=w> </span><span class=o>[</span>OPTIONS<span class=o>]</span>
</code></pre></div> <h3 id=22-qemu>2.2. QEMU编译测试框架<a class=headerlink href=#22-qemu title="Permanent link">&para;</a></h3> <h4 id=221-qemu>2.2.1. QEMU编译框架<a class=headerlink href=#221-qemu title="Permanent link">&para;</a></h4> <h5 id=2211-configure>2.2.1.1. configure<a class=headerlink href=#2211-configure title="Permanent link">&para;</a></h5> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Modifying configure</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Python virtual environments and the build process</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Bundled Python packages</li> </ul> <h5 id=2212-meson>2.2.1.2. Meson<a class=headerlink href=#2212-meson title="Permanent link">&para;</a></h5> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Adding checks</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Support scripts</li> </ul> <h5 id=2213-make>2.2.1.3. Make<a class=headerlink href=#2213-make title="Permanent link">&para;</a></h5> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Useful make targets</li> </ul> <h5 id=2214-important-files-for-the-build-system>2.2.1.4. Important files for the build system<a class=headerlink href=#2214-important-files-for-the-build-system title="Permanent link">&para;</a></h5> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Statically defined files</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Dynamically created files</li> </ul> <h4 id=222-qemu-and-kconfig>2.2.2. QEMU and Kconfig<a class=headerlink href=#222-qemu-and-kconfig title="Permanent link">&para;</a></h4> <h5 id=2221-the-kconfig-language>2.2.2.1. The Kconfig language<a class=headerlink href=#2221-the-kconfig-language title="Permanent link">&para;</a></h5> <h5 id=2222-guidelines-for-writing-kconfig-files>2.2.2.2. Guidelines for writing Kconfig files<a class=headerlink href=#2222-guidelines-for-writing-kconfig-files title="Permanent link">&para;</a></h5> <h5 id=2223-writing-and-modifying-default-configurations>2.2.2.3. Writing and modifying default configurations<a class=headerlink href=#2223-writing-and-modifying-default-configurations title="Permanent link">&para;</a></h5> <h5 id=2224-kconfighost>2.2.2.4. Kconfig.host<a class=headerlink href=#2224-kconfighost title="Permanent link">&para;</a></h5> <h4 id=223-qemu-documentation>2.2.3. QEMU Documentation<a class=headerlink href=#223-qemu-documentation title="Permanent link">&para;</a></h4> <h5 id=2231-xtool-and-hx-files>2.2.3.1. xtool and .hx files<a class=headerlink href=#2231-xtool-and-hx-files title="Permanent link">&para;</a></h5> <h4 id=224-testing-in-qemu>2.2.4. Testing in QEMU<a class=headerlink href=#224-testing-in-qemu title="Permanent link">&para;</a></h4> <h5 id=2241-testing-with-make-check>2.2.4.1. Testing with "make check"<a class=headerlink href=#2241-testing-with-make-check title="Permanent link">&para;</a></h5> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Unit tests</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> QTest</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Writing portable test cases</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> QAPI schema tests</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> check-block</li> </ul> <h5 id=2242-qemu-iotests>2.2.4.2. QEMU iotests<a class=headerlink href=#2242-qemu-iotests title="Permanent link">&para;</a></h5> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Writing a new test case</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Debugging a test case</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Test case groups</li> </ul> <h5 id=2243-container-based-tests>2.2.4.3. Container based tests<a class=headerlink href=#2243-container-based-tests title="Permanent link">&para;</a></h5> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Introduction</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Docker Prerequisites</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Podman Prerequisites</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Quickstart</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Registry</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Images</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Tests</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Debugging a Docker test failure</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Options</li> </ul> <h5 id=2244-thread-sanitizer>2.2.4.4. Thread Sanitizer<a class=headerlink href=#2244-thread-sanitizer title="Permanent link">&para;</a></h5> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Thread Sanitizer in Docker</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Building and Testing with TSan</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> TSan Suppressions</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> TSan Annotations</li> </ul> <h5 id=2245-docker-binfmt-image-debian-targets>2.2.4.5. docker-binfmt-image-debian-% targets<a class=headerlink href=#2245-docker-binfmt-image-debian-targets title="Permanent link">&para;</a></h5> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Setting up binfmt_misc</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Example invocation</li> </ul> <h5 id=2246-vm-testing>2.2.4.6. VM testing<a class=headerlink href=#2246-vm-testing title="Permanent link">&para;</a></h5> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Quickstart</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> QEMU binaries</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Make jobs</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <strong>Debugging</strong></li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Manual invocation</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Adding new guests</li> </ul> <h5 id=2247-image-fuzzer-testing>2.2.4.7. Image fuzzer testing<a class=headerlink href=#2247-image-fuzzer-testing title="Permanent link">&para;</a></h5> <h5 id=2248-integration-tests-using-the-avocado-framework>2.2.4.8. Integration tests using the Avocado Framework<a class=headerlink href=#2248-integration-tests-using-the-avocado-framework title="Permanent link">&para;</a></h5> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Running tests</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Manual Installation</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Overview</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> QEMUMachine</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Attribute reference</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Parameter reference</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Skipping tests</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Uninstalling Avocado</li> </ul> <h5 id=2249-testing-with-make-check-tcg>2.2.4.9. Testing with "make check-tcg"<a class=headerlink href=#2249-testing-with-make-check-tcg title="Permanent link">&para;</a></h5> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Running subset of tests</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> TCG test dependencies</li> </ul> <h5 id=22410-other-tcg-tests>2.2.4.10. Other TCG Tests<a class=headerlink href=#22410-other-tcg-tests title="Permanent link">&para;</a></h5> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> KVM Unit Tests</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Linux Test Project</li> </ul> <h5 id=22411-gcc-gcov-support>2.2.4.11. GCC gcov support<a class=headerlink href=#22411-gcc-gcov-support title="Permanent link">&para;</a></h5> <h4 id=225-acpismbios-avocado-tests-using-biosbits>2.2.5. ACPI/SMBIOS avocado tests using biosbits<a class=headerlink href=#225-acpismbios-avocado-tests-using-biosbits title="Permanent link">&para;</a></h4> <h5 id=2251-references>2.2.5.1. References<a class=headerlink href=#2251-references title="Permanent link">&para;</a></h5> <h4 id=226-qtest-device-emulation-testing-framework>2.2.6. QTest Device Emulation Testing Framework<a class=headerlink href=#226-qtest-device-emulation-testing-framework title="Permanent link">&para;</a></h4> <h5 id=2261-qtest-driver-framework>2.2.6.1. Qtest Driver Framework<a class=headerlink href=#2261-qtest-driver-framework title="Permanent link">&para;</a></h5> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> QGraph concepts</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Creating a new driver and its interface</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Adding a new test</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Qgraph API reference</li> </ul> <h5 id=2262-qtest-protocol>2.2.6.2. QTest Protocol<a class=headerlink href=#2262-qtest-protocol title="Permanent link">&para;</a></h5> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Valid requests</li> </ul> <h5 id=2263-libqtest-api-reference>2.2.6.3. libqtest API reference<a class=headerlink href=#2263-libqtest-api-reference title="Permanent link">&para;</a></h5> <h4 id=227-ci>2.2.7. CI<a class=headerlink href=#227-ci title="Permanent link">&para;</a></h4> <h5 id=2271-definition-of-terms>2.2.7.1. Definition of terms<a class=headerlink href=#2271-definition-of-terms title="Permanent link">&para;</a></h5> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Automated tests</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Unit testing</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Functional testing</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> System testing</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Flaky tests</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Gating</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Continuous Integration (CI)</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> References</li> </ul> <h5 id=2272-custom-cicd-variables>2.2.7.2. Custom CI/CD variables<a class=headerlink href=#2272-custom-cicd-variables title="Permanent link">&para;</a></h5> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Set variable globally in the user’s CI namespace</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Set variable manually when pushing a branch or tag to the user’s repository</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Setting aliases in your git config</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Variable naming and grouping</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Maintainer controlled job variables</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Contributor controlled runtime variables</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Other misc variables</li> </ul> <h5 id=2273-jobs-on-custom-runners>2.2.7.3. Jobs on Custom Runners<a class=headerlink href=#2273-jobs-on-custom-runners title="Permanent link">&para;</a></h5> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Machine Setup Howto</li> </ul> <h4 id=228-how-to-use-the-qapi-code-generator>2.2.8. How to use the QAPI code generator<a class=headerlink href=#228-how-to-use-the-qapi-code-generator title="Permanent link">&para;</a></h4> <h5 id=2281-introduction>2.2.8.1. Introduction<a class=headerlink href=#2281-introduction title="Permanent link">&para;</a></h5> <h5 id=2282-the-qapi-schema-language>2.2.8.2. The QAPI schema language<a class=headerlink href=#2282-the-qapi-schema-language title="Permanent link">&para;</a></h5> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Schema syntax</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Built-in Types</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Include directives</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Pragma directives</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Enumeration types</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Type references and array types</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Struct types</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Union types</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Alternate types</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Commands</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Events</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Features</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Naming rules and reserved names</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Downstream extensions</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Configuring the schema</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Documentation comments</li> </ul> <h5 id=2283-client-json-protocol-introspection>2.2.8.3. Client JSON Protocol introspection<a class=headerlink href=#2283-client-json-protocol-introspection title="Permanent link">&para;</a></h5> <h5 id=2284-compatibility-considerations>2.2.8.4. Compatibility considerations<a class=headerlink href=#2284-compatibility-considerations title="Permanent link">&para;</a></h5> <h5 id=2285-code-generation>2.2.8.5. Code generation<a class=headerlink href=#2285-code-generation title="Permanent link">&para;</a></h5> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Code generated for QAPI types</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Code generated for visiting QAPI types</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Code generated for commands</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Code generated for events</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Code generated for introspection</li> </ul> <h4 id=229-fuzzing>2.2.9. Fuzzing<a class=headerlink href=#229-fuzzing title="Permanent link">&para;</a></h4> <h5 id=2291-basics>2.2.9.1. Basics<a class=headerlink href=#2291-basics title="Permanent link">&para;</a></h5> <h5 id=2292-building-the-fuzzers>2.2.9.2. Building the fuzzers<a class=headerlink href=#2292-building-the-fuzzers title="Permanent link">&para;</a></h5> <h5 id=2293-useful-libfuzzer-flags>2.2.9.3. Useful libFuzzer flags<a class=headerlink href=#2293-useful-libfuzzer-flags title="Permanent link">&para;</a></h5> <h5 id=2294-generating-coverage-reports>2.2.9.4. Generating Coverage Reports<a class=headerlink href=#2294-generating-coverage-reports title="Permanent link">&para;</a></h5> <h5 id=2295-adding-a-new-fuzzer>2.2.9.5. Adding a new fuzzer<a class=headerlink href=#2295-adding-a-new-fuzzer title="Permanent link">&para;</a></h5> <h5 id=2296-the-generic-fuzzer>2.2.9.6. The Generic Fuzzer<a class=headerlink href=#2296-the-generic-fuzzer title="Permanent link">&para;</a></h5> <h5 id=2297-oss-fuzz>2.2.9.7. OSS-Fuzz<a class=headerlink href=#2297-oss-fuzz title="Permanent link">&para;</a></h5> <h5 id=2298-building-crash-reproducers>2.2.9.8. Building Crash Reproducers<a class=headerlink href=#2298-building-crash-reproducers title="Permanent link">&para;</a></h5> <h5 id=2299-implementation-details-fuzzer-lifecycle>2.2.9.9. Implementation Details / Fuzzer Lifecycle<a class=headerlink href=#2299-implementation-details-fuzzer-lifecycle title="Permanent link">&para;</a></h5> <h4 id=2210-control-flow-integrity-cfi>2.2.10. Control-Flow Integrity (CFI)<a class=headerlink href=#2210-control-flow-integrity-cfi title="Permanent link">&para;</a></h4> <h5 id=22101-basics>2.2.10.1. Basics<a class=headerlink href=#22101-basics title="Permanent link">&para;</a></h5> <h5 id=22102-building-with-cfi>2.2.10.2. Building with CFI<a class=headerlink href=#22102-building-with-cfi title="Permanent link">&para;</a></h5> <h5 id=22103-using-qemu-built-with-cfi>2.2.10.3. Using QEMU built with CFI<a class=headerlink href=#22103-using-qemu-built-with-cfi title="Permanent link">&para;</a></h5> <h5 id=22104-incompatible-code-with-cfi>2.2.10.4. Incompatible code with CFI<a class=headerlink href=#22104-incompatible-code-with-cfi title="Permanent link">&para;</a></h5> <h5 id=22105-disabling-cfi-for-a-specific-function>2.2.10.5. Disabling CFI for a specific function<a class=headerlink href=#22105-disabling-cfi-for-a-specific-function title="Permanent link">&para;</a></h5> <h5 id=22106-cfi-and-fuzzing>2.2.10.6. CFI and fuzzing<a class=headerlink href=#22106-cfi-and-fuzzing title="Permanent link">&para;</a></h5> <h3 id=23-qemutcg>2.3. QEMU翻译原理TCG<a class=headerlink href=#23-qemutcg title="Permanent link">&para;</a></h3> <h4 id=231-translator-internals>2.3.1. Translator Internals<a class=headerlink href=#231-translator-internals title="Permanent link">&para;</a></h4> <h5 id=2311-cpu-state-optimisations>2.3.1.1. CPU state optimisations<a class=headerlink href=#2311-cpu-state-optimisations title="Permanent link">&para;</a></h5> <h5 id=2312-direct-block-chaining>2.3.1.2. Direct block chaining<a class=headerlink href=#2312-direct-block-chaining title="Permanent link">&para;</a></h5> <h5 id=2313-self-modifying-code-and-translated-code-invalidation>2.3.1.3. Self-modifying code and translated code invalidation<a class=headerlink href=#2313-self-modifying-code-and-translated-code-invalidation title="Permanent link">&para;</a></h5> <h5 id=2314-exception-support>2.3.1.4. Exception support<a class=headerlink href=#2314-exception-support title="Permanent link">&para;</a></h5> <h5 id=2315-mmu-emulation>2.3.1.5. MMU emulation<a class=headerlink href=#2315-mmu-emulation title="Permanent link">&para;</a></h5> <h5 id=2316-profiling-jitted-code>2.3.1.6. Profiling JITted code<a class=headerlink href=#2316-profiling-jitted-code title="Permanent link">&para;</a></h5> <h4 id=232-tcg-intermediate-representation>2.3.2. TCG Intermediate Representation<a class=headerlink href=#232-tcg-intermediate-representation title="Permanent link">&para;</a></h4> <h5 id=2321-introduction>2.3.2.1. Introduction<a class=headerlink href=#2321-introduction title="Permanent link">&para;</a></h5> <h5 id=2322-definitions>2.3.2.2. Definitions<a class=headerlink href=#2322-definitions title="Permanent link">&para;</a></h5> <h5 id=2323-basic-blocks>2.3.2.3. Basic Blocks<a class=headerlink href=#2323-basic-blocks title="Permanent link">&para;</a></h5> <h5 id=2324-operations>2.3.2.4. Operations<a class=headerlink href=#2324-operations title="Permanent link">&para;</a></h5> <h5 id=2325-variables>2.3.2.5. Variables<a class=headerlink href=#2325-variables title="Permanent link">&para;</a></h5> <h5 id=2326-types>2.3.2.6. Types<a class=headerlink href=#2326-types title="Permanent link">&para;</a></h5> <h5 id=2327-helpers>2.3.2.7. Helpers<a class=headerlink href=#2327-helpers title="Permanent link">&para;</a></h5> <h5 id=2328-code-optimizations>2.3.2.8. Code Optimizations<a class=headerlink href=#2328-code-optimizations title="Permanent link">&para;</a></h5> <h5 id=2329-instruction-reference>2.3.2.9. Instruction Reference<a class=headerlink href=#2329-instruction-reference title="Permanent link">&para;</a></h5> <h5 id=23210-backend>2.3.2.10. Backend<a class=headerlink href=#23210-backend title="Permanent link">&para;</a></h5> <h5 id=23211-recommended-coding-rules-for-best-performance>2.3.2.11. Recommended coding rules for best performance<a class=headerlink href=#23211-recommended-coding-rules-for-best-performance title="Permanent link">&para;</a></h5> <h4 id=233-decodetree-specification>2.3.3. Decodetree Specification<a class=headerlink href=#233-decodetree-specification title="Permanent link">&para;</a></h4> <h5 id=2331-fields>2.3.3.1. Fields<a class=headerlink href=#2331-fields title="Permanent link">&para;</a></h5> <h5 id=2332-argument-sets>2.3.3.2. Argument Sets<a class=headerlink href=#2332-argument-sets title="Permanent link">&para;</a></h5> <h5 id=2333-formats>2.3.3.3. Formats<a class=headerlink href=#2333-formats title="Permanent link">&para;</a></h5> <h5 id=2334-patterns>2.3.3.4. Patterns<a class=headerlink href=#2334-patterns title="Permanent link">&para;</a></h5> <h5 id=2335-pattern-groups>2.3.3.5. Pattern Groups<a class=headerlink href=#2335-pattern-groups title="Permanent link">&para;</a></h5> <h4 id=234-multi-threaded-tcg>2.3.4. Multi-threaded TCG<a class=headerlink href=#234-multi-threaded-tcg title="Permanent link">&para;</a></h4> <h5 id=2341-vcpu-scheduling>2.3.4.1. vCPU Scheduling<a class=headerlink href=#2341-vcpu-scheduling title="Permanent link">&para;</a></h5> <h5 id=2342-shared-data-structures>2.3.4.2. Shared Data Structures<a class=headerlink href=#2342-shared-data-structures title="Permanent link">&para;</a></h5> <h5 id=2343-memory-consistency>2.3.4.3. Memory Consistency<a class=headerlink href=#2343-memory-consistency title="Permanent link">&para;</a></h5> <h4 id=235-tcg-instruction-counting>2.3.5. TCG Instruction Counting<a class=headerlink href=#235-tcg-instruction-counting title="Permanent link">&para;</a></h4> <h5 id=2351-core-concepts>2.3.5.1. Core Concepts<a class=headerlink href=#2351-core-concepts title="Permanent link">&para;</a></h5> <h4 id=236-qemu-tcg-plugins>2.3.6. QEMU TCG Plugins<a class=headerlink href=#236-qemu-tcg-plugins title="Permanent link">&para;</a></h4> <h5 id=2361-usage>2.3.6.1. Usage<a class=headerlink href=#2361-usage title="Permanent link">&para;</a></h5> <h5 id=2362-writing-plugins>2.3.6.2. Writing plugins<a class=headerlink href=#2362-writing-plugins title="Permanent link">&para;</a></h5> <h5 id=2363-internals>2.3.6.3. Internals<a class=headerlink href=#2363-internals title="Permanent link">&para;</a></h5> <h5 id=2364-example-plugins>2.3.6.4. Example Plugins<a class=headerlink href=#2364-example-plugins title="Permanent link">&para;</a></h5> <h5 id=2365-api>2.3.6.5. API<a class=headerlink href=#2365-api title="Permanent link">&para;</a></h5> <h4 id=237-execution-recordreplay>2.3.7. Execution Record/Replay<a class=headerlink href=#237-execution-recordreplay title="Permanent link">&para;</a></h4> <h5 id=2371-core-concepts>2.3.7.1. Core concepts<a class=headerlink href=#2371-core-concepts title="Permanent link">&para;</a></h5> <h5 id=2372-virtual-devices>2.3.7.2. Virtual devices<a class=headerlink href=#2372-virtual-devices title="Permanent link">&para;</a></h5> <h5 id=2373-replay-log-format>2.3.7.3. Replay log format<a class=headerlink href=#2373-replay-log-format title="Permanent link">&para;</a></h5> <h3 id=24-qemu>2.4. QEMU 子模块<a class=headerlink href=#24-qemu title="Permanent link">&para;</a></h3> <h4 id=241-the-qemu-object-model-qom>2.4.1. The QEMU Object Model (QOM)<a class=headerlink href=#241-the-qemu-object-model-qom title="Permanent link">&para;</a></h4> <h5 id=2411-the-qom-tree>2.4.1.1. The QOM tree<a class=headerlink href=#2411-the-qom-tree title="Permanent link">&para;</a></h5> <h5 id=2412-creating-a-qom-class>2.4.1.2. Creating a QOM class<a class=headerlink href=#2412-creating-a-qom-class title="Permanent link">&para;</a></h5> <h5 id=2413-standard-type-declaration-and-definition-macros>2.4.1.3. Standard type declaration and definition macros<a class=headerlink href=#2413-standard-type-declaration-and-definition-macros title="Permanent link">&para;</a></h5> <h5 id=2414-device-life-cycle>2.4.1.4. Device Life-cycle<a class=headerlink href=#2414-device-life-cycle title="Permanent link">&para;</a></h5> <h5 id=2415-api-reference>2.4.1.5. API Reference<a class=headerlink href=#2415-api-reference title="Permanent link">&para;</a></h5> <h4 id=242-atomic-operations-in-qemu>2.4.2. Atomic operations in QEMU<a class=headerlink href=#242-atomic-operations-in-qemu title="Permanent link">&para;</a></h4> <h5 id=2421-compiler-memory-barrier>2.4.2.1. Compiler memory barrier<a class=headerlink href=#2421-compiler-memory-barrier title="Permanent link">&para;</a></h5> <h5 id=2422-sequentially-consistent-atomic-access>2.4.2.2. Sequentially consistent atomic access<a class=headerlink href=#2422-sequentially-consistent-atomic-access title="Permanent link">&para;</a></h5> <h5 id=2423-weak-atomic-access-and-manual-memory-barriers>2.4.2.3. Weak atomic access and manual memory barriers<a class=headerlink href=#2423-weak-atomic-access-and-manual-memory-barriers title="Permanent link">&para;</a></h5> <h5 id=2424-comparison-with-linux-kernel-primitives>2.4.2.4. Comparison with Linux kernel primitives<a class=headerlink href=#2424-comparison-with-linux-kernel-primitives title="Permanent link">&para;</a></h5> <h5 id=2425-sources>2.4.2.5. Sources<a class=headerlink href=#2425-sources title="Permanent link">&para;</a></h5> <h4 id=243-block-coroutine-wrapper>2.4.3. block-coroutine-wrapper<a class=headerlink href=#243-block-coroutine-wrapper title="Permanent link">&para;</a></h4> <h5 id=2431-usage>2.4.3.1. Usage<a class=headerlink href=#2431-usage title="Permanent link">&para;</a></h5> <h5 id=2432-links>2.4.3.2. Links<a class=headerlink href=#2432-links title="Permanent link">&para;</a></h5> <h4 id=244-modelling-a-clock-tree-in-qemu>2.4.4. Modelling a clock tree in QEMU<a class=headerlink href=#244-modelling-a-clock-tree-in-qemu title="Permanent link">&para;</a></h4> <h5 id=2441-what-are-clocks>2.4.4.1. What are clocks?<a class=headerlink href=#2441-what-are-clocks title="Permanent link">&para;</a></h5> <h5 id=2442-the-clock-state>2.4.4.2. The clock state<a class=headerlink href=#2442-the-clock-state title="Permanent link">&para;</a></h5> <h5 id=2443-adding-a-new-clock>2.4.4.3. Adding a new clock<a class=headerlink href=#2443-adding-a-new-clock title="Permanent link">&para;</a></h5> <h5 id=2444-clock-callbacks>2.4.4.4. Clock callbacks<a class=headerlink href=#2444-clock-callbacks title="Permanent link">&para;</a></h5> <h5 id=2445-retrieving-clocks-from-a-device>2.4.4.5. Retrieving clocks from a device<a class=headerlink href=#2445-retrieving-clocks-from-a-device title="Permanent link">&para;</a></h5> <h5 id=2446-connecting-two-clocks-together>2.4.4.6. Connecting two clocks together<a class=headerlink href=#2446-connecting-two-clocks-together title="Permanent link">&para;</a></h5> <h5 id=2447-clock-multiplier-and-divider-settings>2.4.4.7. Clock multiplier and divider settings<a class=headerlink href=#2447-clock-multiplier-and-divider-settings title="Permanent link">&para;</a></h5> <h5 id=2448-unconnected-input-clocks>2.4.4.8. Unconnected input clocks<a class=headerlink href=#2448-unconnected-input-clocks title="Permanent link">&para;</a></h5> <h5 id=2449-fetching-clock-frequencyperiod>2.4.4.9. Fetching clock frequency/period<a class=headerlink href=#2449-fetching-clock-frequencyperiod title="Permanent link">&para;</a></h5> <h5 id=24410-calculating-expiry-deadlines>2.4.4.10. Calculating expiry deadlines<a class=headerlink href=#24410-calculating-expiry-deadlines title="Permanent link">&para;</a></h5> <h5 id=24411-obtaining-tick-counts>2.4.4.11. Obtaining tick counts<a class=headerlink href=#24411-obtaining-tick-counts title="Permanent link">&para;</a></h5> <h5 id=24412-changing-a-clock-period>2.4.4.12. Changing a clock period<a class=headerlink href=#24412-changing-a-clock-period title="Permanent link">&para;</a></h5> <h5 id=24413-aliasing-clocks>2.4.4.13. Aliasing clocks<a class=headerlink href=#24413-aliasing-clocks title="Permanent link">&para;</a></h5> <h5 id=24414-migration>2.4.4.14. Migration<a class=headerlink href=#24414-migration title="Permanent link">&para;</a></h5> <h4 id=245-ebpf-rss-virtio-net-support>2.4.5. eBPF RSS virtio-net support<a class=headerlink href=#245-ebpf-rss-virtio-net-support title="Permanent link">&para;</a></h4> <h5 id=2451-rss-ebpf-program>2.4.5.1. RSS eBPF program<a class=headerlink href=#2451-rss-ebpf-program title="Permanent link">&para;</a></h5> <h5 id=2452-ebpf-rss-implementation>2.4.5.2. eBPF RSS implementation<a class=headerlink href=#2452-ebpf-rss-implementation title="Permanent link">&para;</a></h5> <h4 id=246-migration>2.4.6. Migration<a class=headerlink href=#246-migration title="Permanent link">&para;</a></h4> <h5 id=2461-migration-framework>2.4.6.1. Migration framework<a class=headerlink href=#2461-migration-framework title="Permanent link">&para;</a></h5> <h5 id=2462-migration-features>2.4.6.2. Migration features<a class=headerlink href=#2462-migration-features title="Permanent link">&para;</a></h5> <h5 id=2463-backwards-compatibility>2.4.6.3. Backwards compatibility<a class=headerlink href=#2463-backwards-compatibility title="Permanent link">&para;</a></h5> <h5 id=2464-best-practices>2.4.6.4. Best practices<a class=headerlink href=#2464-best-practices title="Permanent link">&para;</a></h5> <h4 id=247-multi-process-qemu>2.4.7. Multi-process QEMU<a class=headerlink href=#247-multi-process-qemu title="Permanent link">&para;</a></h4> <h5 id=2471-qemu-services>2.4.7.1. QEMU services<a class=headerlink href=#2471-qemu-services title="Permanent link">&para;</a></h5> <h5 id=2472-separating-io-services>2.4.7.2. Separating IO services<a class=headerlink href=#2472-separating-io-services title="Permanent link">&para;</a></h5> <h5 id=2473-new-separation-model-based-on-proxy-objects>2.4.7.3. New separation model based on proxy objects<a class=headerlink href=#2473-new-separation-model-based-on-proxy-objects title="Permanent link">&para;</a></h5> <h5 id=2474-disaggregated-cpu-emulation>2.4.7.4. Disaggregated CPU emulation<a class=headerlink href=#2474-disaggregated-cpu-emulation title="Permanent link">&para;</a></h5> <h5 id=2475-host-access-controls>2.4.7.5. Host access controls<a class=headerlink href=#2475-host-access-controls title="Permanent link">&para;</a></h5> <h4 id=248-reset-in-qemu-the-resettable-interface>2.4.8. Reset in QEMU: the Resettable interface<a class=headerlink href=#248-reset-in-qemu-the-resettable-interface title="Permanent link">&para;</a></h4> <h5 id=2481-triggering-reset>2.4.8.1. Triggering reset<a class=headerlink href=#2481-triggering-reset title="Permanent link">&para;</a></h5> <h5 id=2482-multi-phase-mechanism>2.4.8.2. Multi-phase mechanism<a class=headerlink href=#2482-multi-phase-mechanism title="Permanent link">&para;</a></h5> <h5 id=2483-handling-reset-in-a-resettable-object>2.4.8.3. Handling reset in a resettable object<a class=headerlink href=#2483-handling-reset-in-a-resettable-object title="Permanent link">&para;</a></h5> <h5 id=2484-base-class-handling-of-reset>2.4.8.4. Base class handling of reset<a class=headerlink href=#2484-base-class-handling-of-reset title="Permanent link">&para;</a></h5> <h4 id=249-qapi-interface-for-s390-cpu-topology>2.4.9. QAPI interface for S390 CPU topology<a class=headerlink href=#249-qapi-interface-for-s390-cpu-topology title="Permanent link">&para;</a></h4> <h5 id=2491-additions-to-query-cpus-fast>2.4.9.1. Additions to query-cpus-fast<a class=headerlink href=#2491-additions-to-query-cpus-fast title="Permanent link">&para;</a></h5> <h5 id=2492-qapi-command-set-cpu-topology>2.4.9.2. QAPI command: set-cpu-topology<a class=headerlink href=#2492-qapi-command-set-cpu-topology title="Permanent link">&para;</a></h5> <h5 id=2493-qapi-event-cpu_polarization_change>2.4.9.3. QAPI event CPU_POLARIZATION_CHANGE<a class=headerlink href=#2493-qapi-event-cpu_polarization_change title="Permanent link">&para;</a></h5> <h5 id=2494-qapi-query-command-query-s390x-cpu-polarization>2.4.9.4. QAPI query command: query-s390x-cpu-polarization<a class=headerlink href=#2494-qapi-query-command-query-s390x-cpu-polarization title="Permanent link">&para;</a></h5> <h4 id=2410-booting-from-real-channel-attached-devices-on-s390x>2.4.10. Booting from real channel-attached devices on s390x<a class=headerlink href=#2410-booting-from-real-channel-attached-devices-on-s390x title="Permanent link">&para;</a></h4> <h5 id=24101-s390-hardware-ipl>2.4.10.1. s390 hardware IPL<a class=headerlink href=#24101-s390-hardware-ipl title="Permanent link">&para;</a></h5> <h5 id=24102-how-this-all-pertains-to-qemu-and-the-kernel>2.4.10.2. How this all pertains to QEMU (and the kernel)<a class=headerlink href=#24102-how-this-all-pertains-to-qemu-and-the-kernel title="Permanent link">&para;</a></h5> <h5 id=24103-what-qemu-does>2.4.10.3. What QEMU does<a class=headerlink href=#24103-what-qemu-does title="Permanent link">&para;</a></h5> <h4 id=2411-tracing>2.4.11. Tracing<a class=headerlink href=#2411-tracing title="Permanent link">&para;</a></h4> <h5 id=24111-introduction>2.4.11.1. Introduction<a class=headerlink href=#24111-introduction title="Permanent link">&para;</a></h5> <h5 id=24112-quickstart>2.4.11.2. Quickstart<a class=headerlink href=#24112-quickstart title="Permanent link">&para;</a></h5> <h5 id=24113-trace-events>2.4.11.3. Trace events<a class=headerlink href=#24113-trace-events title="Permanent link">&para;</a></h5> <h5 id=24114-generic-interface-and-monitor-commands>2.4.11.4. Generic interface and monitor commands<a class=headerlink href=#24114-generic-interface-and-monitor-commands title="Permanent link">&para;</a></h5> <h5 id=24115-trace-backends>2.4.11.5. Trace backends<a class=headerlink href=#24115-trace-backends title="Permanent link">&para;</a></h5> <h5 id=24116-trace-event-properties>2.4.11.6. Trace event properties<a class=headerlink href=#24116-trace-event-properties title="Permanent link">&para;</a></h5> <h4 id=2412-iommufd-backend-usage-with-vfio>2.4.12. IOMMUFD BACKEND usage with VFIO<a class=headerlink href=#2412-iommufd-backend-usage-with-vfio title="Permanent link">&para;</a></h4> <h5 id=24121-example-configuration>2.4.12.1. Example configuration<a class=headerlink href=#24121-example-configuration title="Permanent link">&para;</a></h5> <h5 id=24122-supported-platform>2.4.12.2. Supported platform<a class=headerlink href=#24122-supported-platform title="Permanent link">&para;</a></h5> <h5 id=24123-caveats>2.4.12.3. Caveats<a class=headerlink href=#24123-caveats title="Permanent link">&para;</a></h5> <h4 id=2413-how-to-write-monitor-commands>2.4.13. How to write monitor commands<a class=headerlink href=#2413-how-to-write-monitor-commands title="Permanent link">&para;</a></h4> <h5 id=24131-overview>2.4.13.1. Overview<a class=headerlink href=#24131-overview title="Permanent link">&para;</a></h5> <h5 id=24132-testing>2.4.13.2. Testing<a class=headerlink href=#24132-testing title="Permanent link">&para;</a></h5> <h5 id=24133-writing-a-simple-command-hello-world>2.4.13.3. Writing a simple command: hello-world<a class=headerlink href=#24133-writing-a-simple-command-hello-world title="Permanent link">&para;</a></h5> <h5 id=24134-writing-more-complex-commands>2.4.13.4. Writing more complex commands<a class=headerlink href=#24134-writing-more-complex-commands title="Permanent link">&para;</a></h5> <h5 id=24135-writing-a-debugging-aid-returning-unstructured-text>2.4.13.5. Writing a debugging aid returning unstructured text<a class=headerlink href=#24135-writing-a-debugging-aid-returning-unstructured-text title="Permanent link">&para;</a></h5> <h4 id=2414-writing-virtio-backends-for-qemu>2.4.14. Writing VirtIO backends for QEMU<a class=headerlink href=#2414-writing-virtio-backends-for-qemu title="Permanent link">&para;</a></h4> <h5 id=24141-virtio-transports>2.4.14.1. VirtIO Transports<a class=headerlink href=#24141-virtio-transports title="Permanent link">&para;</a></h5> <h5 id=24142-using-the-qemu-object-model-qom>2.4.14.2. Using the QEMU Object Model (QOM)<a class=headerlink href=#24142-using-the-qemu-object-model-qom title="Permanent link">&para;</a></h5> <h5 id=24143-back-end-implementations>2.4.14.3. Back End Implementations<a class=headerlink href=#24143-back-end-implementations title="Permanent link">&para;</a></h5> <h3 id=25-qemu>2.5. QEMU 目录结构<a class=headerlink href=#25-qemu title="Permanent link">&para;</a></h3> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> accel/<ul> <li>CPU 模拟包含硬件加速</li> </ul> </li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> audio/ <ul> <li>音频的后端模拟</li> <li><a href=https://www.jianshu.com/p/d2e3c91a8b45>Qemu Audio</a></li> </ul> </li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> authz/</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> backends/<ul> <li>QEMU处理Guest数据的机制，例如块设备的存储、网络设备和块设备的重定向</li> </ul> </li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> block/<ul> <li>block.c</li> <li>blockdev.c</li> <li>blockdev-nbd.c</li> <li>blockjob.c</li> <li>块设备的后端模拟</li> </ul> </li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> bsd-user/<ul> <li>BSD系统的user模式</li> </ul> </li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> capstone/<ul> <li>反汇编器，在进行二进制翻译的时候，其实最开始的行为是将二进制代码反汇编成为 Guest 指令，然后才是让翻译器将 Guest 指令翻译为 tcg IR，QEMU 也可以使用 disas 来替换内置的反汇编器</li> </ul> </li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> chardev/<ul> <li>字符设备的后端模拟</li> </ul> </li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> configure<ul> <li>编译qemu的配置文件</li> </ul> </li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> contrib/<ul> <li>qemu的辅助工具</li> <li>elf2dmp/</li> <li>gitdm/</li> <li>ivshmem-client/</li> <li>ivshmem-server/</li> <li>plugins/</li> <li>rdmacm-mux/</li> <li>systemd/</li> <li>vhost-user-blk/</li> <li>vhost-user-gpu/</li> <li>vhost-user-input/</li> <li>vhost-user-scsi/</li> </ul> </li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> cpu.c</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> cpus-common.c<ul> <li>CPU核的模拟</li> </ul> </li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> crypto/<ul> <li>加密设备的后端模拟</li> </ul> </li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> default-configs/<ul> <li>编译qemu的Kconfig配置</li> </ul> </li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> disas/<ul> <li>disas.c</li> <li>反汇编器，在进行二进制翻译的时候，其实最开始的行为是将二进制代码反汇编成为 Guest 指令，然后才是让翻译器将 Guest 指令翻译为 tcg IR，QEMU 也可以使用 capstone 来替换内置的反汇编器</li> </ul> </li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> docs/<ul> <li>QEMU文档</li> </ul> </li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> dtc/<ul> <li>设备树模拟</li> </ul> </li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> dump/<ul> <li>dump QEMU内存</li> </ul> </li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> exec-vary.c</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> fpu/<ul> <li>浮点数计算模块模拟</li> </ul> </li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> fsdev/<ul> <li>可以使用 virtio fs4 和 plan 9 来让 Guest 和 Host 共享目录</li> </ul> </li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> gdbstub.c<ul> <li>gdb-xml/</li> <li>和 gdb 配合使用，可以调试 guest 内核</li> </ul> </li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> gitdm.config<ul> <li>gitdm的配置文件</li> </ul> </li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> hmp-commands.hx</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> hmp-commands-info.hx<ul> <li>hmp使用提示</li> </ul> </li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> hw/<ul> <li>各种硬件设备的前端模拟</li> </ul> </li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> include/<ul> <li>qemu架构的头文件</li> </ul> </li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> io/<ul> <li>iothread.c</li> <li>io模拟</li> </ul> </li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> job.c<ul> <li>job-qmp.c</li> </ul> </li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> libdecnumber/</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> linux-headers/</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> linux-user/</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> memory_ldst.c.inc</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> migration/<ul> <li>热迁移虚拟机</li> </ul> </li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> module-common.c</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> monitor/<ul> <li>qemu monitor功能</li> </ul> </li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> nbd/<ul> <li>利用 Linux 内核的 ndb 功能，QEMU 可以用远程的 blockdev 来模拟 guest 的 blockdev</li> </ul> </li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> net/<ul> <li>网络设备的后端模拟</li> </ul> </li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> os-posix.c</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> os-win32.c</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> pc-bios/</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> plugins/</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> po/</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> python/</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> qapi/</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> qemu.nsi</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> qemu.sasl</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> qemu-bridge-helper.c</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> qemu-edid.c</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> qemu-img.c</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> qemu-img-cmds.hx</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> qemu-io.c</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> qemu-io-cmds.c</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> qemu-keymap.c</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> qemu-nbd.c</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> qemu-options.h</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> qemu-options.hx</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> qemu-options-wrapper.h</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> qga/</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> qobject/</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> qom/</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> README.rst</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> replay/</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> replication.c</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> replication.h</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> roms/</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> scripts/</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> scsi/</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> semihosting/</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> slirp/<ul> <li>用户态网络栈</li> </ul> </li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> softmmu/<ul> <li>系统模式的入口</li> </ul> </li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> storage-daemon/</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> stubs/</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> subprojects/</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> target/<ul> <li>各种架构的tcg前端</li> </ul> </li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> tcg/<ul> <li>tcg后端</li> </ul> </li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> tests/<ul> <li>qemu的用例测试</li> </ul> </li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> thunk.c</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> tools/</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> trace/</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> trace-events</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> ui/</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> util/</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> VERSION</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> version.rc</li> </ul> <h2 id=3>3. 笔记<a class=headerlink href=#3 title="Permanent link">&para;</a></h2> <h3 id=31>3.1. 虚拟化是什么？<a class=headerlink href=#31 title="Permanent link">&para;</a></h3> <p>参考文档</p> <blockquote> <ol> <li><a href=https://zhuanlan.zhihu.com/p/441287815>虚拟化是什么</a></li> <li><a href=https://cloud.tencent.com/developer/article/1769577>虚拟化技术概述</a></li> </ol> </blockquote> <hr> <p>VMM（Virtual Machine Monitor）和hypervisor都是<code>虚拟机监控器</code>的意思</p> <p>虚拟化本质是指<code>硬件资源的抽象化</code>，即将以下资源</p> <ul> <li>计算【CPU + memory】</li> <li>网络【NIC】</li> <li>存储【Disk】</li> </ul> <p>最小单位化（池化），以便上层应用能够按需使用资源。虚拟化不但解放了操作系统，也解放了物理硬件，大大提高了资源的利用率。虚拟化技术主要是通过截获上层操作系统应用对硬件资源的访问，然后重定向到hypervisor/VMM（Virtual Machine Monitor）的资源池中，再由 VMM 来对片上资源进行管理。</p> <p><code>虚拟机可以看作是物理机的一种高效隔离的复制</code>，有以下三个典型特征：</p> <ul> <li><code>同质</code>，虚拟机的运行环境和物理机的环境本质上相同，但是表现上能够有一些差异</li> <li><code>高效</code>，虚拟机中运行的软件需要有接近物理机（native）中运行的性能</li> <li><code>资源受控</code>，VMM 需要对系统资源有完全控制能力和管理权限，资源的分配 / 监控 / 回收</li> </ul> <p><a class=glightbox href=../image/virtual_machine_plan.png data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src=../image/virtual_machine_plan.png alt=虚拟机方案 style="width: 80%; height: 80%;"></a></p> <hr> <p>一般来说，存在以下四种虚拟化类型：</p> <ol> <li>操作系统级别虚拟化（OS-level virtulization）</li> <li>全虚拟化（Full virtualization）</li> <li>类/半虚拟化（Para virtulization）</li> <li>混合虚拟化（Hybrid-Para virtualization）</li> </ol> <p><a class=glightbox href=../image/virtual_machine_type.png data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src=../image/virtual_machine_type.png alt=虚拟化类型 style="width: 60%; height: 60%;"></a></p> <p>操作系统级别的虚拟化技术</p> <ul> <li>不需要对于底层进行改动或者考虑 OS，也没有所谓的 VMM 去监管分配底层资源，而是通过 OS 共享内核的方式，为<code>上层应用</code>提供多个完成且隔离的环境（"the kernel allows the existence of multiple isolated user space instances"），这些实例（instances），就被称之为 <code>容器（container）</code>，虚拟化资源和性能开销很小，而且也不需要硬件的支持，是一种轻量化的虚拟化实现技术。</li> </ul> <p>类/半虚拟化（Para virtulization）</p> <ul> <li>但是有些情况 VMM 虚拟的平台是现实中不存在的（要经过 VMM 重新定义，需要对于客户机的 OS 进行修改）。</li> </ul> <p>完全虚拟化（Full virtulization）</p> <ul> <li>VMM 虚拟的是现实存在的平台，而且客户机不知道自己是虚拟出来的平台，以为是真实的平台，不需要对于 OS 进行修改。</li> <li> <p>对于完全虚拟化，可以通过硬件/软件辅助的方式来实现。</p> <p><a class=glightbox href=../image/full_virtual_machine_plan.png data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src=../image/full_virtual_machine_plan.png alt=全虚拟化 style="width: 60%; height: 60%;"></a></p> <ul> <li> <p>Type-1 Hypervisor，或者称之为 Bare-metal Hypervisor，虚拟机直接运行在 Hardware 之上，系统上电之后加载运行虚拟机监控程序，资源的调度是 HW-&gt;VMM-&gt;VM；这种虚拟机将上层的 OS 和底层的硬件脱离，所以上层的软件也不依赖或者局限于特殊的硬件设备或者驱动。</p> <p><a class=glightbox href=../image/Type_1_Hypervisor.png data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src=../image/Type_1_Hypervisor.png alt="Type-1 Hypervisor" style="width: 60%; height: 60%;"></a></p> </li> <li> <p>Type-2 Hypervisor，或者称之为 Hosted Hypervisor，虚拟机不是直接运行在硬件资源之上，而是在操作系统之上；所以系统上电之后，会先启动操作系统，然后加载运行虚拟机监控程序，资源的调度是 HW -&gt; OS -&gt; VMM -&gt; VM。</p> <p><a class=glightbox href=../image/Type_2_Hypervisor.png data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src=../image/Type_2_Hypervisor.png alt="Type-2 Hypervisor" style="width: 60%; height: 60%;"></a></p> </li> <li> <p>Type 1 的虚拟机监控程序可以视为一个为虚拟机进行设计裁剪的操作系统内核，Type 2 的虚拟机监控程序依赖于操作系统来进行调度和管理，所以会有限制性；</p> </li> </ul> </li> </ul> <h3 id=32-qemu>3.2. Qemu是全虚拟化吗？<a class=headerlink href=#32-qemu title="Permanent link">&para;</a></h3> <p><a class=glightbox href=../image/kvm.jpeg data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src=../image/kvm.jpeg alt=QEMU架构 style="width: 60%; height: 60%;"></a></p> <blockquote> <ol> <li><a href=https://zhuanlan.zhihu.com/p/628520188>半虚拟化技术 - VIRTIO 简介</a></li> <li><a href=https://zhuanlan.zhihu.com/p/660108879>硬件辅助虚拟化 DPU</a></li> <li><a href=https://zhuanlan.zhihu.com/p/409507738>DPU 的演化</a></li> </ol> </blockquote> <p>Qemu支持全虚拟化、半虚拟化、硬件辅助虚拟化</p> <p>全虚拟化方案中，QEMU 模拟整个设备，效率低下，virtio 应运而生，定义了虚拟设备与虚拟机如何通信，提高了虚拟化效率。全虚拟方案中，虚拟机以寄存器的方式访问外设，比如网卡发送一个报文，需要写很多次寄存器(会带来 vm_exit/vm_enter)，virio 协议重点解决的就是这种不必要的性能损失，虚拟机与物理机使用 vring 传输数据，避免了频繁了上下文切换。</p> <p>而后 virtio 从最初完全基于 QEMU 实现，到后来在物理机内核态实现 vhost-net，性能在逐渐提升。再到与 DPDK 搭配的 vhost-user（在物理机用户态实现的 virtio 后端），配合 OVS 使虚拟机间的通信效率提升。</p> <h2 id=4>4. 参考材料<a class=headerlink href=#4 title="Permanent link">&para;</a></h2> <ul> <li><a href=https://www.qemu.org/docs/master/index.html>QEMU官方简介</a></li> <li><a href=https://wiki.archlinuxcn.org/wiki/QEMU>archLinux的QEMU翻译</a></li> <li><a href=https://quard-star-tutorial.readthedocs.io/zh-cn/latest/index.html>基于qemu从零开始构建嵌入式linux系统</a></li> <li><a href=https://www.ibm.com/cn-zh/topics/iaas-paas-saas>iaas-paas-saas</a></li> </ul> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2024 - 2024 Pikaqiu </div> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": ["navigation.top"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../assets/javascripts/bundle.1e8ae164.min.js></script> <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>